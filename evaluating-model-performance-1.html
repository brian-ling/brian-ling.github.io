<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 20 Evaluating Model Performance | STAT 362 R for Data Science</title>
  <meta name="description" content="Notes for STAT 362" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 20 Evaluating Model Performance | STAT 362 R for Data Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notes for STAT 362" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 20 Evaluating Model Performance | STAT 362 R for Data Science" />
  
  <meta name="twitter:description" content="Notes for STAT 362" />
  

<meta name="author" content="Brian Ling" />


<meta name="date" content="2024-03-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="shrinkage-methods.html"/>
<link rel="next" href="using-c-in-r-with-rcpp.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Syllabus</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> What is R and RStudio?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.2</b> Why R?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-will-you-learn-in-this-course"><i class="fa fa-check"></i><b>1.3</b> What will you learn in this course?</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#r-and-r-as-a-programming-language"><i class="fa fa-check"></i><b>1.3.1</b> R and R as a programming language</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#data-wrangling"><i class="fa fa-check"></i><b>1.3.2</b> Data Wrangling</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#data-visualization"><i class="fa fa-check"></i><b>1.3.3</b> Data Visualization</a></li>
<li class="chapter" data-level="1.3.4" data-path="introduction.html"><a href="introduction.html#statistical-inference"><i class="fa fa-check"></i><b>1.3.4</b> Statistical Inference</a></li>
<li class="chapter" data-level="1.3.5" data-path="introduction.html"><a href="introduction.html#machine-learning"><i class="fa fa-check"></i><b>1.3.5</b> Machine Learning</a></li>
<li class="chapter" data-level="1.3.6" data-path="introduction.html"><a href="introduction.html#some-numerical-methods"><i class="fa fa-check"></i><b>1.3.6</b> Some Numerical Methods</a></li>
<li class="chapter" data-level="1.3.7" data-path="introduction.html"><a href="introduction.html#lastly"><i class="fa fa-check"></i><b>1.3.7</b> Lastly</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#lets-get-started"><i class="fa fa-check"></i><b>1.4</b> Letâ€™s Get Started</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#r-data-structures"><i class="fa fa-check"></i><b>1.5</b> R Data Structures</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="introduction.html"><a href="introduction.html#vectors"><i class="fa fa-check"></i><b>1.5.1</b> Vectors</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction.html"><a href="introduction.html#factors"><i class="fa fa-check"></i><b>1.5.2</b> Factors</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction.html"><a href="introduction.html#matrix"><i class="fa fa-check"></i><b>1.5.3</b> Matrix</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction.html"><a href="introduction.html#lists"><i class="fa fa-check"></i><b>1.5.4</b> Lists</a></li>
<li class="chapter" data-level="1.5.5" data-path="introduction.html"><a href="introduction.html#data-frames"><i class="fa fa-check"></i><b>1.5.5</b> Data frames</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#operators"><i class="fa fa-check"></i><b>1.6</b> Operators</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction.html"><a href="introduction.html#vectorized-operators"><i class="fa fa-check"></i><b>1.6.1</b> Vectorized Operators</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#built-in-functions"><i class="fa fa-check"></i><b>1.7</b> Built-in Functions</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction.html"><a href="introduction.html#sort"><i class="fa fa-check"></i><b>1.7.1</b> <code>sort()</code></a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction.html"><a href="introduction.html#seq"><i class="fa fa-check"></i><b>1.7.2</b> <code>seq()</code></a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction.html"><a href="introduction.html#rep"><i class="fa fa-check"></i><b>1.7.3</b> <code>rep()</code></a></li>
<li class="chapter" data-level="1.7.4" data-path="introduction.html"><a href="introduction.html#pmax-pmin"><i class="fa fa-check"></i><b>1.7.4</b> <code>pmax</code>, <code>pmin</code></a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#some-useful-rstudio-shortcuts"><i class="fa fa-check"></i><b>1.8</b> Some Useful RStudio Shortcuts</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.9</b> Exercises</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#comments-to-exercises"><i class="fa fa-check"></i><b>1.10</b> Comments to Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability-and-simulation.html"><a href="probability-and-simulation.html"><i class="fa fa-check"></i><b>2</b> Probability and Simulation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="probability-and-simulation.html"><a href="probability-and-simulation.html#probability-distributions"><i class="fa fa-check"></i><b>2.1</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="probability-and-simulation.html"><a href="probability-and-simulation.html#common-distributions"><i class="fa fa-check"></i><b>2.1.1</b> Common Distributions</a></li>
<li class="chapter" data-level="2.1.2" data-path="probability-and-simulation.html"><a href="probability-and-simulation.html#exercises-1"><i class="fa fa-check"></i><b>2.1.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability-and-simulation.html"><a href="probability-and-simulation.html#simulation"><i class="fa fa-check"></i><b>2.2</b> Simulation</a></li>
<li class="chapter" data-level="2.3" data-path="probability-and-simulation.html"><a href="probability-and-simulation.html#additional-exercises"><i class="fa fa-check"></i><b>2.3</b> Additional Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programming-in-r.html"><a href="programming-in-r.html"><i class="fa fa-check"></i><b>3</b> Programming in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="programming-in-r.html"><a href="programming-in-r.html#writing-functions-in-r"><i class="fa fa-check"></i><b>3.1</b> Writing functions in R</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="programming-in-r.html"><a href="programming-in-r.html#argument-matching"><i class="fa fa-check"></i><b>3.1.1</b> Argument Matching</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="programming-in-r.html"><a href="programming-in-r.html#control-flow"><i class="fa fa-check"></i><b>3.2</b> Control Flow</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="programming-in-r.html"><a href="programming-in-r.html#for-loop"><i class="fa fa-check"></i><b>3.2.1</b> for loop</a></li>
<li class="chapter" data-level="3.2.2" data-path="programming-in-r.html"><a href="programming-in-r.html#nested-for-loop"><i class="fa fa-check"></i><b>3.2.2</b> nested for loop</a></li>
<li class="chapter" data-level="3.2.3" data-path="programming-in-r.html"><a href="programming-in-r.html#while-loop"><i class="fa fa-check"></i><b>3.2.3</b> while loop</a></li>
<li class="chapter" data-level="3.2.4" data-path="programming-in-r.html"><a href="programming-in-r.html#if-cond"><i class="fa fa-check"></i><b>3.2.4</b> if (cond)</a></li>
<li class="chapter" data-level="3.2.5" data-path="programming-in-r.html"><a href="programming-in-r.html#if-cond-else-expr"><i class="fa fa-check"></i><b>3.2.5</b> if (cond) else expr</a></li>
<li class="chapter" data-level="3.2.6" data-path="programming-in-r.html"><a href="programming-in-r.html#if-else-ladder"><i class="fa fa-check"></i><b>3.2.6</b> If else ladder</a></li>
<li class="chapter" data-level="3.2.7" data-path="programming-in-r.html"><a href="programming-in-r.html#switch"><i class="fa fa-check"></i><b>3.2.7</b> <code>switch</code></a></li>
<li class="chapter" data-level="3.2.8" data-path="programming-in-r.html"><a href="programming-in-r.html#next-break"><i class="fa fa-check"></i><b>3.2.8</b> <code>next</code>, <code>break</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="programming-in-r.html"><a href="programming-in-r.html#loop-functions"><i class="fa fa-check"></i><b>3.3</b> Loop functions</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="programming-in-r.html"><a href="programming-in-r.html#apply"><i class="fa fa-check"></i><b>3.3.1</b> <code>apply()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="programming-in-r.html"><a href="programming-in-r.html#lapply"><i class="fa fa-check"></i><b>3.3.2</b> <code>lapply()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="programming-in-r.html"><a href="programming-in-r.html#automatically-reindent-code"><i class="fa fa-check"></i><b>3.4</b> Automatically Reindent Code</a></li>
<li class="chapter" data-level="3.5" data-path="programming-in-r.html"><a href="programming-in-r.html#speed-consideration"><i class="fa fa-check"></i><b>3.5</b> Speed Consideration</a></li>
<li class="chapter" data-level="3.6" data-path="programming-in-r.html"><a href="programming-in-r.html#additional-exercises-1"><i class="fa fa-check"></i><b>3.6</b> Additional Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html"><i class="fa fa-check"></i><b>4</b> Managing Data with R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#missing-values"><i class="fa fa-check"></i><b>4.1</b> Missing Values</a></li>
<li class="chapter" data-level="4.2" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#saving-loading-and-removing-r-data-structures"><i class="fa fa-check"></i><b>4.2</b> Saving, loading, and removing R data structures</a></li>
<li class="chapter" data-level="4.3" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#importing-and-saving-data-from-csv-files"><i class="fa fa-check"></i><b>4.3</b> Importing and saving data from CSV files</a></li>
<li class="chapter" data-level="4.4" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#data-transformation-with-dplyr"><i class="fa fa-check"></i><b>4.4</b> Data Transformation with <code>dplyr</code></a></li>
<li class="chapter" data-level="4.5" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#arrange"><i class="fa fa-check"></i><b>4.5</b> <code>arrange()</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#exercises-2"><i class="fa fa-check"></i><b>4.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#filter"><i class="fa fa-check"></i><b>4.6</b> <code>filter()</code></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#exercises-3"><i class="fa fa-check"></i><b>4.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#select"><i class="fa fa-check"></i><b>4.7</b> <code>select()</code></a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#exercises-4"><i class="fa fa-check"></i><b>4.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#mutate"><i class="fa fa-check"></i><b>4.8</b> <code>mutate()</code></a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#exercises-5"><i class="fa fa-check"></i><b>4.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#summarize-group_by"><i class="fa fa-check"></i><b>4.9</b> <code>summarize(), group_by()</code></a></li>
<li class="chapter" data-level="4.10" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#combining-multiple-operations-with-pipe"><i class="fa fa-check"></i><b>4.10</b> Combining Multiple Operations with Pipe <code>%&gt;%</code></a></li>
<li class="chapter" data-level="4.11" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#summary"><i class="fa fa-check"></i><b>4.11</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html"><i class="fa fa-check"></i><b>5</b> Creating Some Basic Plots</a>
<ul>
<li class="chapter" data-level="5.1" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#scatter-plot"><i class="fa fa-check"></i><b>5.1</b> Scatter Plot</a></li>
<li class="chapter" data-level="5.2" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#line-graph"><i class="fa fa-check"></i><b>5.2</b> Line Graph</a></li>
<li class="chapter" data-level="5.3" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#bar-chart"><i class="fa fa-check"></i><b>5.3</b> Bar Chart</a></li>
<li class="chapter" data-level="5.4" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#histogram"><i class="fa fa-check"></i><b>5.4</b> Histogram</a></li>
<li class="chapter" data-level="5.5" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#box-plot"><i class="fa fa-check"></i><b>5.5</b> Box Plot</a></li>
<li class="chapter" data-level="5.6" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#plotting-a-function-curve"><i class="fa fa-check"></i><b>5.6</b> Plotting a function curve</a></li>
<li class="chapter" data-level="5.7" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#more-on-plots-with-base-r"><i class="fa fa-check"></i><b>5.7</b> More on plots with base R</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#multi-frame-plot"><i class="fa fa-check"></i><b>5.7.1</b> Multi-frame plot</a></li>
<li class="chapter" data-level="5.7.2" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#subsubsec:type_of_plot"><i class="fa fa-check"></i><b>5.7.2</b> Type of Plot</a></li>
<li class="chapter" data-level="5.7.3" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#parameters-of-a-plot"><i class="fa fa-check"></i><b>5.7.3</b> Parameters of a plot</a></li>
<li class="chapter" data-level="5.7.4" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#elements-on-plot"><i class="fa fa-check"></i><b>5.7.4</b> Elements on plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>6</b> Data Visualization with ggplot2</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#bar-charts"><i class="fa fa-check"></i><b>6.1</b> Bar charts</a></li>
<li class="chapter" data-level="6.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#line-graph-1"><i class="fa fa-check"></i><b>6.2</b> Line Graph</a></li>
<li class="chapter" data-level="6.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>6.3</b> Scatter Plots</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#overplotting"><i class="fa fa-check"></i><b>6.3.1</b> Overplotting</a></li>
<li class="chapter" data-level="6.3.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#labelling-points-in-a-scatter-plot"><i class="fa fa-check"></i><b>6.3.2</b> Labelling points in a scatter plot</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#summarizing-data-distributions"><i class="fa fa-check"></i><b>6.4</b> Summarizing Data Distributions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#histogram-1"><i class="fa fa-check"></i><b>6.4.1</b> Histogram</a></li>
<li class="chapter" data-level="6.4.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#kernel-density-estimate"><i class="fa fa-check"></i><b>6.4.2</b> Kernel Density Estimate</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#saving-your-plots"><i class="fa fa-check"></i><b>6.5</b> Saving your plots</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#outputting-to-pdf-vector-files"><i class="fa fa-check"></i><b>6.5.1</b> Outputting to pdf vector files</a></li>
<li class="chapter" data-level="6.5.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#outputting-to-bitmap-files"><i class="fa fa-check"></i><b>6.5.2</b> Outputting to bitmap files</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#axes-appearance"><i class="fa fa-check"></i><b>6.6</b> Axes, appearance</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#swapping-x--and-y-axes"><i class="fa fa-check"></i><b>6.6.1</b> Swapping X- and Y-axes</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#setting-the-range-of-a-continuous-axis"><i class="fa fa-check"></i><b>6.6.2</b> Setting the range of a continuous axis</a></li>
<li class="chapter" data-level="6.6.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#changing-the-text-of-axis-labels"><i class="fa fa-check"></i><b>6.6.3</b> Changing the text of axis labels</a></li>
<li class="chapter" data-level="6.6.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#adding-title"><i class="fa fa-check"></i><b>6.6.4</b> Adding Title</a></li>
<li class="chapter" data-level="6.6.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#adding-subtitle"><i class="fa fa-check"></i><b>6.6.5</b> Adding Subtitle</a></li>
<li class="chapter" data-level="6.6.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#using-themes"><i class="fa fa-check"></i><b>6.6.6</b> Using Themes</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#summary-1"><i class="fa fa-check"></i><b>6.7</b> Summary</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#bar-charts-1"><i class="fa fa-check"></i><b>6.7.1</b> Bar charts</a></li>
<li class="chapter" data-level="6.7.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#line-graphs"><i class="fa fa-check"></i><b>6.7.2</b> Line graphs</a></li>
<li class="chapter" data-level="6.7.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#scatter-plot-1"><i class="fa fa-check"></i><b>6.7.3</b> Scatter plot</a></li>
<li class="chapter" data-level="6.7.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#summarizing-data-distributions-1"><i class="fa fa-check"></i><b>6.7.4</b> Summarizing data distributions</a></li>
<li class="chapter" data-level="6.7.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#saving-your-plots-1"><i class="fa fa-check"></i><b>6.7.5</b> Saving your plots</a></li>
<li class="chapter" data-level="6.7.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#axes-appearance-1"><i class="fa fa-check"></i><b>6.7.6</b> Axes, appearance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html"><i class="fa fa-check"></i><b>7</b> Statistical Inference in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>7.1</b> Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#exercises-on-mle"><i class="fa fa-check"></i><b>7.1.1</b> Exercises on MLE</a></li>
<li class="chapter" data-level="7.1.2" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#summary-2"><i class="fa fa-check"></i><b>7.1.2</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#interval-estimation-and-hypothesis-testing"><i class="fa fa-check"></i><b>7.2</b> Interval Estimation and Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#examples-of-hypothesis-testing"><i class="fa fa-check"></i><b>7.2.1</b> Examples of Hypothesis Testing</a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#null-hypotheses-alternative-hypotheses-and-p-values"><i class="fa fa-check"></i><b>7.2.2</b> Null Hypotheses, Alternative Hypotheses, and p-values</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#type-i-error-and-type-ii-error"><i class="fa fa-check"></i><b>7.2.3</b> Type I error and Type II error</a></li>
<li class="chapter" data-level="7.2.4" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#inference-for-mean-of-one-sample"><i class="fa fa-check"></i><b>7.2.4</b> Inference for Mean of One Sample</a></li>
<li class="chapter" data-level="7.2.5" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#comparing-the-means-of-two-samples"><i class="fa fa-check"></i><b>7.2.5</b> Comparing the means of two samples</a></li>
<li class="chapter" data-level="7.2.6" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#inference-of-a-sample-proportion"><i class="fa fa-check"></i><b>7.2.6</b> Inference of a Sample Proportion</a></li>
<li class="chapter" data-level="7.2.7" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#testing-groups-for-equal-proportions"><i class="fa fa-check"></i><b>7.2.7</b> Testing groups for equal proportions</a></li>
<li class="chapter" data-level="7.2.8" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#testing-if-two-samples-have-the-same-underlying-distribution"><i class="fa fa-check"></i><b>7.2.8</b> Testing if two samples have the same underlying distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html"><i class="fa fa-check"></i><b>8</b> Root finding and optimization</a>
<ul>
<li class="chapter" data-level="8.1" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#root-finding"><i class="fa fa-check"></i><b>8.1</b> Root Finding</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#bisection-method"><i class="fa fa-check"></i><b>8.1.1</b> Bisection Method</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#newton-raphson-method"><i class="fa fa-check"></i><b>8.2</b> Newton-Raphson Method</a></li>
<li class="chapter" data-level="8.3" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#minimization-and-maximization"><i class="fa fa-check"></i><b>8.3</b> Minimization and Maximization</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#newton-raphson-method-1"><i class="fa fa-check"></i><b>8.3.1</b> Newton-Raphson Method</a></li>
<li class="chapter" data-level="8.3.2" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#gradient-descent"><i class="fa fa-check"></i><b>8.3.2</b> Gradient Descent</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#optim"><i class="fa fa-check"></i><b>8.4</b> <code>optim</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html"><i class="fa fa-check"></i><b>9</b> k-nearest neighbors</a>
<ul>
<li class="chapter" data-level="9.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#feature-scaling"><i class="fa fa-check"></i><b>9.2</b> Feature Scaling</a></li>
<li class="chapter" data-level="9.3" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#example-classifying-breast-cancers"><i class="fa fa-check"></i><b>9.3</b> Example: Classifying Breast Cancers</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#evaluating-model-performance"><i class="fa fa-check"></i><b>9.3.1</b> Evaluating Model Performance</a></li>
<li class="chapter" data-level="9.3.2" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#using-z-score-standardization"><i class="fa fa-check"></i><b>9.3.2</b> Using <span class="math inline">\(z\)</span>-score standardization</a></li>
<li class="chapter" data-level="9.3.3" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#testing-alternative-values-of-k"><i class="fa fa-check"></i><b>9.3.3</b> Testing alternative values of <span class="math inline">\(k\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="linear-regression-models.html"><a href="linear-regression-models.html"><i class="fa fa-check"></i><b>10</b> Linear Regression Models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="linear-regression-models.html"><a href="linear-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>10.1</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="10.2" data-path="linear-regression-models.html"><a href="linear-regression-models.html#smoothed-conditional-means"><i class="fa fa-check"></i><b>10.2</b> Smoothed Conditional Means</a></li>
<li class="chapter" data-level="10.3" data-path="linear-regression-models.html"><a href="linear-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>10.3</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="10.4" data-path="linear-regression-models.html"><a href="linear-regression-models.html#example-diamonds"><i class="fa fa-check"></i><b>10.4</b> Example: <code>diamonds</code></a></li>
<li class="chapter" data-level="10.5" data-path="linear-regression-models.html"><a href="linear-regression-models.html#categorical-predictors"><i class="fa fa-check"></i><b>10.5</b> Categorical Predictors</a></li>
<li class="chapter" data-level="10.6" data-path="linear-regression-models.html"><a href="linear-regression-models.html#compare-models-using-anova"><i class="fa fa-check"></i><b>10.6</b> Compare models using ANOVA</a></li>
<li class="chapter" data-level="10.7" data-path="linear-regression-models.html"><a href="linear-regression-models.html#prediction"><i class="fa fa-check"></i><b>10.7</b> Prediction</a></li>
<li class="chapter" data-level="10.8" data-path="linear-regression-models.html"><a href="linear-regression-models.html#interaction-terms"><i class="fa fa-check"></i><b>10.8</b> Interaction Terms</a></li>
<li class="chapter" data-level="10.9" data-path="linear-regression-models.html"><a href="linear-regression-models.html#variable-transformation"><i class="fa fa-check"></i><b>10.9</b> Variable Transformation</a></li>
<li class="chapter" data-level="10.10" data-path="linear-regression-models.html"><a href="linear-regression-models.html#polynomial-regression"><i class="fa fa-check"></i><b>10.10</b> Polynomial Regression</a></li>
<li class="chapter" data-level="10.11" data-path="linear-regression-models.html"><a href="linear-regression-models.html#stepwise-regression"><i class="fa fa-check"></i><b>10.11</b> Stepwise regression</a></li>
<li class="chapter" data-level="10.12" data-path="linear-regression-models.html"><a href="linear-regression-models.html#best-subset"><i class="fa fa-check"></i><b>10.12</b> Best subset</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html"><i class="fa fa-check"></i><b>11</b> Logistic Regression Model</a></li>
<li class="chapter" data-level="12" data-path="multinomial-regression-model.html"><a href="multinomial-regression-model.html"><i class="fa fa-check"></i><b>12</b> Multinomial Regression Model</a></li>
<li class="chapter" data-level="13" data-path="decision-trees.html"><a href="decision-trees.html"><i class="fa fa-check"></i><b>13</b> Decision Trees</a>
<ul>
<li class="chapter" data-level="13.1" data-path="decision-trees.html"><a href="decision-trees.html#introduction-to-classification-tree"><i class="fa fa-check"></i><b>13.1</b> Introduction to Classification Tree</a></li>
<li class="chapter" data-level="13.2" data-path="decision-trees.html"><a href="decision-trees.html#introduction-to-regression-tree"><i class="fa fa-check"></i><b>13.2</b> Introduction to regression tree</a></li>
<li class="chapter" data-level="13.3" data-path="decision-trees.html"><a href="decision-trees.html#mathematical-formulation"><i class="fa fa-check"></i><b>13.3</b> Mathematical Formulation</a></li>
<li class="chapter" data-level="13.4" data-path="decision-trees.html"><a href="decision-trees.html#examples"><i class="fa fa-check"></i><b>13.4</b> Examples</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="decision-trees.html"><a href="decision-trees.html#classification-tree"><i class="fa fa-check"></i><b>13.4.1</b> Classification Tree</a></li>
<li class="chapter" data-level="13.4.2" data-path="decision-trees.html"><a href="decision-trees.html#regression-tree"><i class="fa fa-check"></i><b>13.4.2</b> Regression Tree</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>14</b> Resampling Methods</a>
<ul>
<li class="chapter" data-level="14.1" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation"><i class="fa fa-check"></i><b>14.1</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#estimate-test-errors"><i class="fa fa-check"></i><b>14.1.1</b> Estimate Test Errors</a></li>
<li class="chapter" data-level="14.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#model-selection"><i class="fa fa-check"></i><b>14.1.2</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap-optional"><i class="fa fa-check"></i><b>14.2</b> Bootstrap (optional)</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ensemble-methods.html"><a href="ensemble-methods.html"><i class="fa fa-check"></i><b>15</b> Ensemble Methods</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#bagging"><i class="fa fa-check"></i><b>15.1</b> Bagging</a></li>
<li class="chapter" data-level="15.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-forest"><i class="fa fa-check"></i><b>15.2</b> Random Forest</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#example"><i class="fa fa-check"></i><b>15.2.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting"><i class="fa fa-check"></i><b>15.3</b> Boosting</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#example-1"><i class="fa fa-check"></i><b>15.3.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>16</b> R Markdown</a>
<ul>
<li class="chapter" data-level="16.1" data-path="r-markdown.html"><a href="r-markdown.html#basic-formatting"><i class="fa fa-check"></i><b>16.1</b> Basic formatting</a></li>
<li class="chapter" data-level="16.2" data-path="r-markdown.html"><a href="r-markdown.html#this-is-a-subsection"><i class="fa fa-check"></i><b>16.2</b> This is a subsection</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="r-markdown.html"><a href="r-markdown.html#this-is-a-subsubsection"><i class="fa fa-check"></i><b>16.2.1</b> This is a subsubsection</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="r-markdown.html"><a href="r-markdown.html#formatting-text"><i class="fa fa-check"></i><b>16.3</b> Formatting Text</a></li>
<li class="chapter" data-level="16.4" data-path="r-markdown.html"><a href="r-markdown.html#list"><i class="fa fa-check"></i><b>16.4</b> List</a></li>
<li class="chapter" data-level="16.5" data-path="r-markdown.html"><a href="r-markdown.html#table"><i class="fa fa-check"></i><b>16.5</b> Table</a></li>
<li class="chapter" data-level="16.6" data-path="r-markdown.html"><a href="r-markdown.html#r-code"><i class="fa fa-check"></i><b>16.6</b> R code</a></li>
<li class="chapter" data-level="16.7" data-path="r-markdown.html"><a href="r-markdown.html#graphics"><i class="fa fa-check"></i><b>16.7</b> Graphics</a></li>
<li class="chapter" data-level="16.8" data-path="r-markdown.html"><a href="r-markdown.html#latex-equation"><i class="fa fa-check"></i><b>16.8</b> Latex Equation</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>17</b> k-means Clustering</a>
<ul>
<li class="chapter" data-level="17.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#introduction-2"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="k-means-clustering.html"><a href="k-means-clustering.html#applications"><i class="fa fa-check"></i><b>17.2</b> Applications</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#cluster-analysis"><i class="fa fa-check"></i><b>17.2.1</b> Cluster Analysis</a></li>
<li class="chapter" data-level="17.2.2" data-path="k-means-clustering.html"><a href="k-means-clustering.html#image-segementation-and-image-compression"><i class="fa fa-check"></i><b>17.2.2</b> Image Segementation and Image Compression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html"><i class="fa fa-check"></i><b>18</b> Hierarchical Clustering</a>
<ul>
<li class="chapter" data-level="18.1" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#dissimilarity-measure-and-linkage"><i class="fa fa-check"></i><b>18.1</b> Dissimilarity measure and Linkage</a></li>
<li class="chapter" data-level="18.2" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#alogrithm"><i class="fa fa-check"></i><b>18.2</b> Alogrithm</a></li>
<li class="chapter" data-level="18.3" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#applications-1"><i class="fa fa-check"></i><b>18.3</b> Applications</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#nci60-data"><i class="fa fa-check"></i><b>18.3.1</b> NCI60 Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html"><i class="fa fa-check"></i><b>19</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="19.1" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#ridge-regression"><i class="fa fa-check"></i><b>19.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="19.2" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#lasso"><i class="fa fa-check"></i><b>19.2</b> LASSO</a></li>
<li class="chapter" data-level="19.3" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#selecting-the-tuning-parameter"><i class="fa fa-check"></i><b>19.3</b> Selecting the tuning parameter</a></li>
<li class="chapter" data-level="19.4" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#glmnet"><i class="fa fa-check"></i><b>19.4</b> <code>glmnet</code></a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#ridge-regression-1"><i class="fa fa-check"></i><b>19.4.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="19.4.2" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#lasso-1"><i class="fa fa-check"></i><b>19.4.2</b> LASSO</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#penalized-logistic-regression"><i class="fa fa-check"></i><b>19.5</b> Penalized Logistic Regression</a></li>
<li class="chapter" data-level="19.6" data-path="shrinkage-methods.html"><a href="shrinkage-methods.html#penalized-multinomial-regression"><i class="fa fa-check"></i><b>19.6</b> Penalized Multinomial Regression</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html"><i class="fa fa-check"></i><b>20</b> Evaluating Model Performance</a>
<ul>
<li class="chapter" data-level="20.1" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#accuracy-and-confusion-matrix"><i class="fa fa-check"></i><b>20.1</b> Accuracy and Confusion Matrix</a></li>
<li class="chapter" data-level="20.2" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#other-measures-of-performance"><i class="fa fa-check"></i><b>20.2</b> Other Measures of Performance</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#the-kappa-statistic"><i class="fa fa-check"></i><b>20.2.1</b> The kappa statistic</a></li>
<li class="chapter" data-level="20.2.2" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#sensitivity-and-specificity"><i class="fa fa-check"></i><b>20.2.2</b> Sensitivity and specificity</a></li>
<li class="chapter" data-level="20.2.3" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#precision-and-recall"><i class="fa fa-check"></i><b>20.2.3</b> Precision and Recall</a></li>
<li class="chapter" data-level="20.2.4" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#roc-and-auc"><i class="fa fa-check"></i><b>20.2.4</b> ROC and AUC</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#estimating-future-performances"><i class="fa fa-check"></i><b>20.3</b> Estimating future performances</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#cross-validation-1"><i class="fa fa-check"></i><b>20.3.1</b> Cross-validation</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="evaluating-model-performance-1.html"><a href="evaluating-model-performance-1.html#class-imbalance-in-classification"><i class="fa fa-check"></i><b>20.4</b> Class Imbalance in Classification</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html"><i class="fa fa-check"></i><b>21</b> Using C++ in R with Rcpp</a>
<ul>
<li class="chapter" data-level="21.1" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#basic-examples"><i class="fa fa-check"></i><b>21.1</b> Basic Examples</a></li>
<li class="chapter" data-level="21.2" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#scalar-input-scalar-output"><i class="fa fa-check"></i><b>21.2</b> Scalar Input, Scalar Output</a></li>
<li class="chapter" data-level="21.3" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#vector-input-scalar-ouptut"><i class="fa fa-check"></i><b>21.3</b> Vector Input, Scalar Ouptut</a></li>
<li class="chapter" data-level="21.4" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#vector-input-vector-output"><i class="fa fa-check"></i><b>21.4</b> Vector Input, Vector Output</a></li>
<li class="chapter" data-level="21.5" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#returning-a-list"><i class="fa fa-check"></i><b>21.5</b> Returning a list</a></li>
<li class="chapter" data-level="21.6" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#using-sourcecpp"><i class="fa fa-check"></i><b>21.6</b> Using <code>sourceCpp</code></a></li>
<li class="chapter" data-level="21.7" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#example-gibbs-sampler"><i class="fa fa-check"></i><b>21.7</b> Example: Gibbs Sampler</a></li>
<li class="chapter" data-level="21.8" data-path="using-c-in-r-with-rcpp.html"><a href="using-c-in-r-with-rcpp.html#more-details"><i class="fa fa-check"></i><b>21.8</b> More Details</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 362 R for Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="evaluating-model-performance-1" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">Chapter 20</span> Evaluating Model Performance<a href="evaluating-model-performance-1.html#evaluating-model-performance-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Packages used in this chapter:</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="evaluating-model-performance-1.html#cb536-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb536-2"><a href="evaluating-model-performance-1.html#cb536-2" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb536-3"><a href="evaluating-model-performance-1.html#cb536-3" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb536-4"><a href="evaluating-model-performance-1.html#cb536-4" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span>
<span id="cb536-5"><a href="evaluating-model-performance-1.html#cb536-5" tabindex="-1"></a><span class="fu">library</span>(DMwR)</span></code></pre></div>
<div id="accuracy-and-confusion-matrix" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Accuracy and Confusion Matrix<a href="evaluating-model-performance-1.html#accuracy-and-confusion-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We have defined Accuracy as</p>
<p><span class="math display">\[\begin{equation*}
\text{Accuracy} = \frac{\text{number of correct predictions}}{\text{total number of predictions}}.
\end{equation*}\]</span></p>
<p>However, the class imbalance problem below will show that this measure may not be a good measure of model performance in many cases.</p>
<p><strong>Class imbalance problem</strong></p>
<ul>
<li><p>If you have a model with <span class="math inline">\(99\%\)</span> accuracy, does that mean the model is useful?</p></li>
<li><p>Imagine a disease that is found 11 out of every 1000 people.</p></li>
<li><p>A model that predicts <strong>no disease</strong> will have an accuracy of <span class="math inline">\(989/1000 = 98.9\%\)</span>, which is just slightly lower than the accuracy of your model.</p></li>
<li><p>This shows that accuracy alone may not be a particular useful measure of performance in many applications.</p></li>
<li><p>Class imbalance problem = the trouble associated with data having a large majority of records belonging to a single class</p></li>
</ul>
<p>Another problem is that accuracy does not tell us whether the model is good at identifying the positive cases or the negative cases.</p>
<p>Additionally, the consequence of having false negatives can be more severe than having false positives.</p>
<!-- Two types of predictions: -->
<!-- 1. predicted class value -->
<!-- 2. estimated probability of the prediction -->
<p><strong>Confusion matrices</strong></p>
<p>We have already seen some confusion matrices in previous chapters.</p>
<ul>
<li><p>A confusion matrix is a table that categorizes predictions according to whether they match the actual value.</p></li>
<li><p>Correct predictions fall on the diagonal in the confusion matrix</p></li>
</ul>
<p>Recall the logistic regression example:</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="evaluating-model-performance-1.html#cb537-1" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span>
<span id="cb537-2"><a href="evaluating-model-performance-1.html#cb537-2" tabindex="-1"></a></span>
<span id="cb537-3"><a href="evaluating-model-performance-1.html#cb537-3" tabindex="-1"></a><span class="fu">data</span>(PimaIndiansDiabetes2)</span>
<span id="cb537-4"><a href="evaluating-model-performance-1.html#cb537-4" tabindex="-1"></a>PimaIndiansDiabetes2 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(PimaIndiansDiabetes2)</span>
<span id="cb537-5"><a href="evaluating-model-performance-1.html#cb537-5" tabindex="-1"></a></span>
<span id="cb537-6"><a href="evaluating-model-performance-1.html#cb537-6" tabindex="-1"></a><span class="co"># Split the data into training and test set</span></span>
<span id="cb537-7"><a href="evaluating-model-performance-1.html#cb537-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb537-8"><a href="evaluating-model-performance-1.html#cb537-8" tabindex="-1"></a>random_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(PimaIndiansDiabetes2), </span>
<span id="cb537-9"><a href="evaluating-model-performance-1.html#cb537-9" tabindex="-1"></a>                       <span class="at">size =</span> <span class="fu">nrow</span>(PimaIndiansDiabetes2) <span class="sc">*</span> <span class="fl">0.7</span>)</span>
<span id="cb537-10"><a href="evaluating-model-performance-1.html#cb537-10" tabindex="-1"></a>train_data  <span class="ot">&lt;-</span> PimaIndiansDiabetes2[random_index, ]</span>
<span id="cb537-11"><a href="evaluating-model-performance-1.html#cb537-11" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> PimaIndiansDiabetes2[<span class="sc">-</span>random_index, ]</span>
<span id="cb537-12"><a href="evaluating-model-performance-1.html#cb537-12" tabindex="-1"></a>fit_simple <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> glucose, <span class="at">data =</span> train_data, <span class="at">family =</span> binomial)</span>
<span id="cb537-13"><a href="evaluating-model-performance-1.html#cb537-13" tabindex="-1"></a></span>
<span id="cb537-14"><a href="evaluating-model-performance-1.html#cb537-14" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb537-15"><a href="evaluating-model-performance-1.html#cb537-15" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_simple, test_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb537-16"><a href="evaluating-model-performance-1.html#cb537-16" tabindex="-1"></a>predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">&quot;pos&quot;</span>, <span class="st">&quot;neg&quot;</span>)</span></code></pre></div>
<p>We can use the function <code>CrossTable()</code> from the package <code>gmodels</code> to create a confusion matrix with some additional information.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="evaluating-model-performance-1.html#cb538-1" tabindex="-1"></a><span class="fu">library</span>(gmodels)</span>
<span id="cb538-2"><a href="evaluating-model-performance-1.html#cb538-2" tabindex="-1"></a><span class="fu">CrossTable</span>(predicted_class, test_data<span class="sc">$</span>diabetes, <span class="at">prop.chisq =</span> <span class="cn">FALSE</span>) </span>
<span id="cb538-3"><a href="evaluating-model-performance-1.html#cb538-3" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb538-4"><a href="evaluating-model-performance-1.html#cb538-4" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb538-5"><a href="evaluating-model-performance-1.html#cb538-5" tabindex="-1"></a><span class="do">##    Cell Contents</span></span>
<span id="cb538-6"><a href="evaluating-model-performance-1.html#cb538-6" tabindex="-1"></a><span class="do">## |-------------------------|</span></span>
<span id="cb538-7"><a href="evaluating-model-performance-1.html#cb538-7" tabindex="-1"></a><span class="do">## |                       N |</span></span>
<span id="cb538-8"><a href="evaluating-model-performance-1.html#cb538-8" tabindex="-1"></a><span class="do">## |           N / Row Total |</span></span>
<span id="cb538-9"><a href="evaluating-model-performance-1.html#cb538-9" tabindex="-1"></a><span class="do">## |           N / Col Total |</span></span>
<span id="cb538-10"><a href="evaluating-model-performance-1.html#cb538-10" tabindex="-1"></a><span class="do">## |         N / Table Total |</span></span>
<span id="cb538-11"><a href="evaluating-model-performance-1.html#cb538-11" tabindex="-1"></a><span class="do">## |-------------------------|</span></span>
<span id="cb538-12"><a href="evaluating-model-performance-1.html#cb538-12" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb538-13"><a href="evaluating-model-performance-1.html#cb538-13" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb538-14"><a href="evaluating-model-performance-1.html#cb538-14" tabindex="-1"></a><span class="do">## Total Observations in Table:  118 </span></span>
<span id="cb538-15"><a href="evaluating-model-performance-1.html#cb538-15" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb538-16"><a href="evaluating-model-performance-1.html#cb538-16" tabindex="-1"></a><span class="do">##  </span></span>
<span id="cb538-17"><a href="evaluating-model-performance-1.html#cb538-17" tabindex="-1"></a><span class="do">##                 | test_data$diabetes </span></span>
<span id="cb538-18"><a href="evaluating-model-performance-1.html#cb538-18" tabindex="-1"></a><span class="do">## predicted_class |       neg |       pos | Row Total | </span></span>
<span id="cb538-19"><a href="evaluating-model-performance-1.html#cb538-19" tabindex="-1"></a><span class="do">## ----------------|-----------|-----------|-----------|</span></span>
<span id="cb538-20"><a href="evaluating-model-performance-1.html#cb538-20" tabindex="-1"></a><span class="do">##             neg |        71 |        23 |        94 | </span></span>
<span id="cb538-21"><a href="evaluating-model-performance-1.html#cb538-21" tabindex="-1"></a><span class="do">##                 |     0.755 |     0.245 |     0.797 | </span></span>
<span id="cb538-22"><a href="evaluating-model-performance-1.html#cb538-22" tabindex="-1"></a><span class="do">##                 |     0.899 |     0.590 |           | </span></span>
<span id="cb538-23"><a href="evaluating-model-performance-1.html#cb538-23" tabindex="-1"></a><span class="do">##                 |     0.602 |     0.195 |           | </span></span>
<span id="cb538-24"><a href="evaluating-model-performance-1.html#cb538-24" tabindex="-1"></a><span class="do">## ----------------|-----------|-----------|-----------|</span></span>
<span id="cb538-25"><a href="evaluating-model-performance-1.html#cb538-25" tabindex="-1"></a><span class="do">##             pos |         8 |        16 |        24 | </span></span>
<span id="cb538-26"><a href="evaluating-model-performance-1.html#cb538-26" tabindex="-1"></a><span class="do">##                 |     0.333 |     0.667 |     0.203 | </span></span>
<span id="cb538-27"><a href="evaluating-model-performance-1.html#cb538-27" tabindex="-1"></a><span class="do">##                 |     0.101 |     0.410 |           | </span></span>
<span id="cb538-28"><a href="evaluating-model-performance-1.html#cb538-28" tabindex="-1"></a><span class="do">##                 |     0.068 |     0.136 |           | </span></span>
<span id="cb538-29"><a href="evaluating-model-performance-1.html#cb538-29" tabindex="-1"></a><span class="do">## ----------------|-----------|-----------|-----------|</span></span>
<span id="cb538-30"><a href="evaluating-model-performance-1.html#cb538-30" tabindex="-1"></a><span class="do">##    Column Total |        79 |        39 |       118 | </span></span>
<span id="cb538-31"><a href="evaluating-model-performance-1.html#cb538-31" tabindex="-1"></a><span class="do">##                 |     0.669 |     0.331 |           | </span></span>
<span id="cb538-32"><a href="evaluating-model-performance-1.html#cb538-32" tabindex="-1"></a><span class="do">## ----------------|-----------|-----------|-----------|</span></span>
<span id="cb538-33"><a href="evaluating-model-performance-1.html#cb538-33" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb538-34"><a href="evaluating-model-performance-1.html#cb538-34" tabindex="-1"></a><span class="do">## </span></span></code></pre></div>
<p>The <span class="math inline">\(3\)</span> proportions are</p>
<ul>
<li>N / Row Total (e.g.Â <span class="math inline">\(71/94 = 0.755\)</span>)</li>
<li>N / Col Total (e.g.Â <span class="math inline">\(71/79 = 0.899\)</span>)</li>
<li>N / Table Total (e.g.Â <span class="math inline">\(71/118 = 0.602\)</span>)</li>
</ul>
<p>In a confusion matrix, predictions fall into one of the four categories:</p>
<ul>
<li>True positive (TP): Correctly classified as the class of interest</li>
<li>True negative (TN): Correctly classified as not the class of interest</li>
<li>False positive (FP): Incorrectly classified as the class of interest</li>
<li>False negative (FN): Incorrectly classified as not the class of interest</li>
</ul>
<p><strong>Positive</strong> = the class of interest</p>
<p>The notations TP, TN, FP and FN are also used to refer to the number of times the predictions fell into each of these categories.</p>
<p>In the logistic regression example, suppose our class of interest is <code>pos</code>.</p>
<ul>
<li>TP = 16</li>
<li>TN = 71</li>
<li>FP = 8</li>
<li>FN = 23</li>
</ul>
</div>
<div id="other-measures-of-performance" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Other Measures of Performance<a href="evaluating-model-performance-1.html#other-measures-of-performance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The package <code>caret</code> contains a function <code>confusionMatrix()</code> to output several useful measures of classification performance. We will talk about some of them in the next section.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="evaluating-model-performance-1.html#cb539-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb539-2"><a href="evaluating-model-performance-1.html#cb539-2" tabindex="-1"></a><span class="co"># requires factor inputs</span></span>
<span id="cb539-3"><a href="evaluating-model-performance-1.html#cb539-3" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> <span class="fu">factor</span>(predicted_class), <span class="at">reference =</span>  <span class="fu">factor</span>(test_data<span class="sc">$</span>diabetes),</span>
<span id="cb539-4"><a href="evaluating-model-performance-1.html#cb539-4" tabindex="-1"></a>                <span class="at">positive =</span> <span class="st">&quot;pos&quot;</span>)</span>
<span id="cb539-5"><a href="evaluating-model-performance-1.html#cb539-5" tabindex="-1"></a><span class="do">## Confusion Matrix and Statistics</span></span>
<span id="cb539-6"><a href="evaluating-model-performance-1.html#cb539-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb539-7"><a href="evaluating-model-performance-1.html#cb539-7" tabindex="-1"></a><span class="do">##           Reference</span></span>
<span id="cb539-8"><a href="evaluating-model-performance-1.html#cb539-8" tabindex="-1"></a><span class="do">## Prediction neg pos</span></span>
<span id="cb539-9"><a href="evaluating-model-performance-1.html#cb539-9" tabindex="-1"></a><span class="do">##        neg  71  23</span></span>
<span id="cb539-10"><a href="evaluating-model-performance-1.html#cb539-10" tabindex="-1"></a><span class="do">##        pos   8  16</span></span>
<span id="cb539-11"><a href="evaluating-model-performance-1.html#cb539-11" tabindex="-1"></a><span class="do">##                                          </span></span>
<span id="cb539-12"><a href="evaluating-model-performance-1.html#cb539-12" tabindex="-1"></a><span class="do">##                Accuracy : 0.7373         </span></span>
<span id="cb539-13"><a href="evaluating-model-performance-1.html#cb539-13" tabindex="-1"></a><span class="do">##                  95% CI : (0.6483, 0.814)</span></span>
<span id="cb539-14"><a href="evaluating-model-performance-1.html#cb539-14" tabindex="-1"></a><span class="do">##     No Information Rate : 0.6695         </span></span>
<span id="cb539-15"><a href="evaluating-model-performance-1.html#cb539-15" tabindex="-1"></a><span class="do">##     P-Value [Acc &gt; NIR] : 0.06908        </span></span>
<span id="cb539-16"><a href="evaluating-model-performance-1.html#cb539-16" tabindex="-1"></a><span class="do">##                                          </span></span>
<span id="cb539-17"><a href="evaluating-model-performance-1.html#cb539-17" tabindex="-1"></a><span class="do">##                   Kappa : 0.3423         </span></span>
<span id="cb539-18"><a href="evaluating-model-performance-1.html#cb539-18" tabindex="-1"></a><span class="do">##                                          </span></span>
<span id="cb539-19"><a href="evaluating-model-performance-1.html#cb539-19" tabindex="-1"></a><span class="do">##  Mcnemar&#39;s Test P-Value : 0.01192        </span></span>
<span id="cb539-20"><a href="evaluating-model-performance-1.html#cb539-20" tabindex="-1"></a><span class="do">##                                          </span></span>
<span id="cb539-21"><a href="evaluating-model-performance-1.html#cb539-21" tabindex="-1"></a><span class="do">##             Sensitivity : 0.4103         </span></span>
<span id="cb539-22"><a href="evaluating-model-performance-1.html#cb539-22" tabindex="-1"></a><span class="do">##             Specificity : 0.8987         </span></span>
<span id="cb539-23"><a href="evaluating-model-performance-1.html#cb539-23" tabindex="-1"></a><span class="do">##          Pos Pred Value : 0.6667         </span></span>
<span id="cb539-24"><a href="evaluating-model-performance-1.html#cb539-24" tabindex="-1"></a><span class="do">##          Neg Pred Value : 0.7553         </span></span>
<span id="cb539-25"><a href="evaluating-model-performance-1.html#cb539-25" tabindex="-1"></a><span class="do">##              Prevalence : 0.3305         </span></span>
<span id="cb539-26"><a href="evaluating-model-performance-1.html#cb539-26" tabindex="-1"></a><span class="do">##          Detection Rate : 0.1356         </span></span>
<span id="cb539-27"><a href="evaluating-model-performance-1.html#cb539-27" tabindex="-1"></a><span class="do">##    Detection Prevalence : 0.2034         </span></span>
<span id="cb539-28"><a href="evaluating-model-performance-1.html#cb539-28" tabindex="-1"></a><span class="do">##       Balanced Accuracy : 0.6545         </span></span>
<span id="cb539-29"><a href="evaluating-model-performance-1.html#cb539-29" tabindex="-1"></a><span class="do">##                                          </span></span>
<span id="cb539-30"><a href="evaluating-model-performance-1.html#cb539-30" tabindex="-1"></a><span class="do">##        &#39;Positive&#39; Class : pos            </span></span>
<span id="cb539-31"><a href="evaluating-model-performance-1.html#cb539-31" tabindex="-1"></a><span class="do">## </span></span></code></pre></div>
<div id="the-kappa-statistic" class="section level3 hasAnchor" number="20.2.1">
<h3><span class="header-section-number">20.2.1</span> The kappa statistic<a href="evaluating-model-performance-1.html#the-kappa-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Idea: we want to adjust accuracy by accounting for the possibility of a correct prediction by chance alone. For example, if the disease is found <span class="math inline">\(11\)</span> out of every <span class="math inline">\(1000\)</span> people, we can predict each case randomly by assigning the positive case with probability <span class="math inline">\(0.989\)</span>. In this way, our accuracy will be <span class="math inline">\(98.9\%\)</span> on average.</p>
<p>Definition of the kappa statistic:</p>
<p><span class="math display">\[\begin{equation*}
\kappa = \frac{p_a - p_e}{1 - p_e},
\end{equation*}\]</span>
where</p>
<ul>
<li><span class="math inline">\(p_a\)</span> is the proportion of actual agreement. That is, <span class="math inline">\(p_a\)</span> is the proportion of all instances where the predicted type and actual type agree. Mathematically,</li>
</ul>
<p><span class="math display">\[\begin{equation*}
p_a = \frac{TP + TN}{TP + TN + FP + FN} = \text{Accuracy}.
\end{equation*}\]</span></p>
<ul>
<li><p><span class="math inline">\(p_e\)</span> is the expected agreement between the classifier and the true values, under the assumption that they were chosen at random. Let</p>
<ul>
<li><p><span class="math inline">\(p_{\text{pos, actual}}\)</span> denote the proportion of the <strong>positive</strong> cases in the <strong>actual data</strong></p></li>
<li><p><span class="math inline">\(p_{\text{neg, actual}}\)</span> denote the proportion of the <strong>negative</strong> cases in the <strong>actual data</strong></p></li>
<li><p><span class="math inline">\(p_{\text{pos, pred}}\)</span> denote the proportion of the <strong>positive</strong> cases in the <strong>predictions</strong></p></li>
<li><p><span class="math inline">\(p_{\text{neg, pred}}\)</span> denote the proportion of <strong>negative</strong> cases in the <strong>predictions</strong></p></li>
</ul></li>
<li><p>Mathematically,</p></li>
</ul>
<p><span class="math display">\[\begin{equation*}
p_e = p_{\text{pos, actual}} \times p_{\text{pos, pred}} + p_{\text{neg, actual}}  \times p_{\text{neg, pred}}.
\end{equation*}\]</span>
This is because there are only two ways to get agreement (both are positive and both are negative) and the predictions are chosen at random (so that the predictions and the actual data are independent -&gt; independence means multiplication in probability).</p>
<p>In the above example,</p>
<ul>
<li><span class="math inline">\(p_a = \frac{16 + 71}{118} = 0.7372881\)</span></li>
<li><span class="math inline">\(p_e = \frac{79}{118} \frac{94}{118} + \frac{39}{118} \frac{24}{118} = 0.6005458\)</span>.</li>
<li><span class="math inline">\(\kappa = \frac{p_a - p_e}{1 - p_e} = 0.342\)</span>.</li>
</ul>
<p>Common interpretation of <span class="math inline">\(\kappa\)</span>:</p>
<ul>
<li>less than <span class="math inline">\(0.2\)</span> = poor agreement</li>
<li><span class="math inline">\(0.2\)</span> to <span class="math inline">\(0.4\)</span> = fair agreement</li>
<li><span class="math inline">\(0.4\)</span> to <span class="math inline">\(0.8\)</span> = moderate agreement</li>
<li><span class="math inline">\(0.6\)</span> to <span class="math inline">\(0.8\)</span> = good agreement</li>
<li><span class="math inline">\(0.8\)</span> to <span class="math inline">\(1\)</span> = very good agreement</li>
</ul>
</div>
<div id="sensitivity-and-specificity" class="section level3 hasAnchor" number="20.2.2">
<h3><span class="header-section-number">20.2.2</span> Sensitivity and specificity<a href="evaluating-model-performance-1.html#sensitivity-and-specificity" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Most of you have probably received some spam (junk email) in your email. Many email providers filter the spam automatically. You may also experience that sometimes some legitimate emails (ham) are classified as spam.</p></li>
<li><p>Finding a useful classifier often involves a balance between predictions that are overly conservative and overly aggressive.</p>
<ul>
<li><p>(Overly Aggressive) For example, you can classify an email as spam if you have never sent an email to that address.</p></li>
<li><p>(Overly Conservative) To guarantee that no ham messages will be inadvertently filtered might require us to allow an unacceptable amount of spam to pass through the filter.</p></li>
</ul></li>
</ul>
<p>A pair of performance measures captures this trade-off: <strong>sensitivity</strong> and <strong>specificity</strong>.</p>
<ul>
<li><p>Sensitivity (also called the true positive rate) is defined as
<span class="math display">\[\begin{equation*}
\text{Sensitivity} = \frac{TP}{TP + FN}.
\end{equation*}\]</span>
It is the proportion of positive examples that are correctly classified. E.g., the proportion of spam filtered.</p></li>
<li><p>Specificity (also called the true negative rate) is defined as
<span class="math display">\[\begin{equation*}
\text{Specificity} = \frac{TN}{TN + FP}.
\end{equation*}\]</span>
It is the proportion of negative examples that are correctly classified. E.g., the proportion of ham not filtered.</p></li>
<li><p>Ideally, we want both of them to be close to <span class="math inline">\(1\)</span>.</p></li>
<li><p>There is usually a tradeoff between the two measures.</p></li>
</ul>
</div>
<div id="precision-and-recall" class="section level3 hasAnchor" number="20.2.3">
<h3><span class="header-section-number">20.2.3</span> Precision and Recall<a href="evaluating-model-performance-1.html#precision-and-recall" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Precision = positive predictive value = proportion of positive examples that are truly positive</p>
<p>Recall = sensitivity = number of true positives / total number of positives</p>
</div>
<div id="roc-and-auc" class="section level3 hasAnchor" number="20.2.4">
<h3><span class="header-section-number">20.2.4</span> ROC and AUC<a href="evaluating-model-performance-1.html#roc-and-auc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ROC = receiver operating characteristic curve</p>
<p>AUC = area under the ROC curve</p>
<p>Recall that in the logistic regression example, we chose <span class="math inline">\(0.5\)</span> as the threshold to decide our predictions. Changing this threshold will change the <strong>sensitivity</strong> and the <strong>specificity</strong> of your model. ROC is a tool to visualize the trade-off between the sensitivity and specificity. In ROC, sensitivity is plot against 1 - specificity at different levels of the threshold. It tells you how well the model perform.</p>
<ul>
<li>A classifier that is closer to the perfect classifier is considered to be better</li>
<li>A classifier that results in a higher AUC is considered to be better</li>
<li>The diagonal line from the bottom-left to the top-right corner of the diagram represents a classifier with no predictive value.</li>
</ul>
<p><img src="Book_files/figure-html/unnamed-chunk-598-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>To understand how ROC is constructed, we use our logistic regression example. The package <code>caret</code> contains the two functions <code>sensitivity</code> and <code>specificity</code> to compute the sensitivity and specificity, respectively. The following code is used to create the above figure (without the dot corresponding to the perfect classifier).</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="evaluating-model-performance-1.html#cb540-1" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb540-2"><a href="evaluating-model-performance-1.html#cb540-2" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb540-3"><a href="evaluating-model-performance-1.html#cb540-3" tabindex="-1"></a>roc_sensitivity <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(threshold))</span>
<span id="cb540-4"><a href="evaluating-model-performance-1.html#cb540-4" tabindex="-1"></a>roc_specificity <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(threshold))</span>
<span id="cb540-5"><a href="evaluating-model-performance-1.html#cb540-5" tabindex="-1"></a></span>
<span id="cb540-6"><a href="evaluating-model-performance-1.html#cb540-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(threshold)) {</span>
<span id="cb540-7"><a href="evaluating-model-performance-1.html#cb540-7" tabindex="-1"></a>  <span class="co"># for each value of threshold, find our predictions</span></span>
<span id="cb540-8"><a href="evaluating-model-performance-1.html#cb540-8" tabindex="-1"></a>  predicted_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(prob <span class="sc">&gt;</span> threshold[i], <span class="st">&quot;pos&quot;</span>, <span class="st">&quot;neg&quot;</span>))</span>
<span id="cb540-9"><a href="evaluating-model-performance-1.html#cb540-9" tabindex="-1"></a>  <span class="co"># compute the corresponding sensitivity and specificity</span></span>
<span id="cb540-10"><a href="evaluating-model-performance-1.html#cb540-10" tabindex="-1"></a>  roc_sensitivity[i] <span class="ot">&lt;-</span> <span class="fu">sensitivity</span>(predicted_class, test_data<span class="sc">$</span>diabetes, <span class="at">positive =</span> <span class="st">&quot;pos&quot;</span>)</span>
<span id="cb540-11"><a href="evaluating-model-performance-1.html#cb540-11" tabindex="-1"></a>  roc_specificity[i]  <span class="ot">&lt;-</span> <span class="fu">specificity</span>(predicted_class, test_data<span class="sc">$</span>diabetes, <span class="at">negative =</span> <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb540-12"><a href="evaluating-model-performance-1.html#cb540-12" tabindex="-1"></a>}</span>
<span id="cb540-13"><a href="evaluating-model-performance-1.html#cb540-13" tabindex="-1"></a></span>
<span id="cb540-14"><a href="evaluating-model-performance-1.html#cb540-14" tabindex="-1"></a><span class="co"># ROC, use geom_path instead of geom_line to retain the order when joining the points</span></span>
<span id="cb540-15"><a href="evaluating-model-performance-1.html#cb540-15" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> roc_specificity, <span class="at">y =</span> roc_sensitivity)) <span class="sc">+</span></span>
<span id="cb540-16"><a href="evaluating-model-performance-1.html#cb540-16" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb540-17"><a href="evaluating-model-performance-1.html#cb540-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;1 - Specificity&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Sensitivity&quot;</span>) <span class="sc">+</span> </span>
<span id="cb540-18"><a href="evaluating-model-performance-1.html#cb540-18" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">1</span>), <span class="at">linetype =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>There is a function called <code>roc()</code> in the package <code>pROC</code> to construct the ROC.</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="evaluating-model-performance-1.html#cb541-1" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb541-2"><a href="evaluating-model-performance-1.html#cb541-2" tabindex="-1"></a></span>
<span id="cb541-3"><a href="evaluating-model-performance-1.html#cb541-3" tabindex="-1"></a>roc_logistic <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">predictor =</span> <span class="fu">as.numeric</span>(prob), <span class="at">response =</span> test_data<span class="sc">$</span>diabetes)</span>
<span id="cb541-4"><a href="evaluating-model-performance-1.html#cb541-4" tabindex="-1"></a></span>
<span id="cb541-5"><a href="evaluating-model-performance-1.html#cb541-5" tabindex="-1"></a><span class="fu">plot</span>(roc_logistic)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-600-1.png" width="50%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="evaluating-model-performance-1.html#cb542-1" tabindex="-1"></a></span>
<span id="cb542-2"><a href="evaluating-model-performance-1.html#cb542-2" tabindex="-1"></a><span class="co"># find the AUC</span></span>
<span id="cb542-3"><a href="evaluating-model-performance-1.html#cb542-3" tabindex="-1"></a><span class="fu">auc</span>(roc_logistic)</span>
<span id="cb542-4"><a href="evaluating-model-performance-1.html#cb542-4" tabindex="-1"></a><span class="do">## Area under the curve: 0.7592</span></span></code></pre></div>
<p>Note that the x-axis label from this function is Specificity starting from 1.</p>
<p>AUC values:</p>
<ul>
<li>0.9-1.0: outstanding</li>
<li>0.8-0.9: excellent/good</li>
<li>0.7-0.8: acceptable/fair</li>
<li>0.6-0.7: poor</li>
<li>0.5-0.6: no discrimination power</li>
</ul>
</div>
</div>
<div id="estimating-future-performances" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Estimating future performances<a href="evaluating-model-performance-1.html#estimating-future-performances" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Recall that in evaluating the model performance, we have partition our data into training and testing datasets. This is known as the holdout method.</p></li>
<li><p>To estimate the future performance, we should not use any part of the testing data when we train our model using our training dataset. Otherwise, our result will be biased.</p></li>
</ul>
<p>One problem with the above random partition is that the proportions of the class of interest are very different in the training dataset and testing datase even if we have randomly selected our observations.</p>
<p><strong>Example</strong></p>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="evaluating-model-performance-1.html#cb543-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb543-2"><a href="evaluating-model-performance-1.html#cb543-2" tabindex="-1"></a>random_index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(PimaIndiansDiabetes2), </span>
<span id="cb543-3"><a href="evaluating-model-performance-1.html#cb543-3" tabindex="-1"></a>                       <span class="at">size =</span> <span class="fu">nrow</span>(PimaIndiansDiabetes2) <span class="sc">*</span> <span class="fl">0.7</span>)</span>
<span id="cb543-4"><a href="evaluating-model-performance-1.html#cb543-4" tabindex="-1"></a>train_data  <span class="ot">&lt;-</span> PimaIndiansDiabetes2[random_index, ]</span>
<span id="cb543-5"><a href="evaluating-model-performance-1.html#cb543-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> PimaIndiansDiabetes2[<span class="sc">-</span>random_index, ]</span>
<span id="cb543-6"><a href="evaluating-model-performance-1.html#cb543-6" tabindex="-1"></a></span>
<span id="cb543-7"><a href="evaluating-model-performance-1.html#cb543-7" tabindex="-1"></a><span class="fu">table</span>(train_data<span class="sc">$</span>diabetes) <span class="sc">/</span> <span class="fu">nrow</span>(train_data)</span>
<span id="cb543-8"><a href="evaluating-model-performance-1.html#cb543-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb543-9"><a href="evaluating-model-performance-1.html#cb543-9" tabindex="-1"></a><span class="do">##      neg      pos </span></span>
<span id="cb543-10"><a href="evaluating-model-performance-1.html#cb543-10" tabindex="-1"></a><span class="do">## 0.649635 0.350365</span></span>
<span id="cb543-11"><a href="evaluating-model-performance-1.html#cb543-11" tabindex="-1"></a></span>
<span id="cb543-12"><a href="evaluating-model-performance-1.html#cb543-12" tabindex="-1"></a><span class="fu">table</span>(test_data<span class="sc">$</span>diabetes) <span class="sc">/</span> <span class="fu">nrow</span>(test_data)</span>
<span id="cb543-13"><a href="evaluating-model-performance-1.html#cb543-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb543-14"><a href="evaluating-model-performance-1.html#cb543-14" tabindex="-1"></a><span class="do">##       neg       pos </span></span>
<span id="cb543-15"><a href="evaluating-model-performance-1.html#cb543-15" tabindex="-1"></a><span class="do">## 0.7118644 0.2881356</span></span></code></pre></div>
<p>You can see that the proportion of <code>pos</code> in the training dataset is <span class="math inline">\(0.350\)</span> while that in the testing dataset is <span class="math inline">\(0.288\)</span>. This may affect the estimation of the model performance.</p>
<p>To avoid this issue, we can use <strong>stratified random sampling</strong> to ensure the training dataset and testing dataset have nearly the same proportion in the class of interest.</p>
<p>To do that in R, we can use the function <code>createDataPartition</code> from the package <code>caret</code>.</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="evaluating-model-performance-1.html#cb544-1" tabindex="-1"></a>stratified_random_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(PimaIndiansDiabetes2<span class="sc">$</span>diabetes,</span>
<span id="cb544-2"><a href="evaluating-model-performance-1.html#cb544-2" tabindex="-1"></a>                                               <span class="at">p =</span> <span class="fl">0.7</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb544-3"><a href="evaluating-model-performance-1.html#cb544-3" tabindex="-1"></a></span>
<span id="cb544-4"><a href="evaluating-model-performance-1.html#cb544-4" tabindex="-1"></a>train_data  <span class="ot">&lt;-</span> PimaIndiansDiabetes2[stratified_random_index, ]</span>
<span id="cb544-5"><a href="evaluating-model-performance-1.html#cb544-5" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> PimaIndiansDiabetes2[<span class="sc">-</span>stratified_random_index, ]</span>
<span id="cb544-6"><a href="evaluating-model-performance-1.html#cb544-6" tabindex="-1"></a></span>
<span id="cb544-7"><a href="evaluating-model-performance-1.html#cb544-7" tabindex="-1"></a><span class="fu">table</span>(train_data<span class="sc">$</span>diabetes) <span class="sc">/</span> <span class="fu">nrow</span>(train_data)</span>
<span id="cb544-8"><a href="evaluating-model-performance-1.html#cb544-8" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb544-9"><a href="evaluating-model-performance-1.html#cb544-9" tabindex="-1"></a><span class="do">##       neg       pos </span></span>
<span id="cb544-10"><a href="evaluating-model-performance-1.html#cb544-10" tabindex="-1"></a><span class="do">## 0.6690909 0.3309091</span></span>
<span id="cb544-11"><a href="evaluating-model-performance-1.html#cb544-11" tabindex="-1"></a></span>
<span id="cb544-12"><a href="evaluating-model-performance-1.html#cb544-12" tabindex="-1"></a><span class="fu">table</span>(test_data<span class="sc">$</span>diabetes) <span class="sc">/</span> <span class="fu">nrow</span>(test_data)</span>
<span id="cb544-13"><a href="evaluating-model-performance-1.html#cb544-13" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb544-14"><a href="evaluating-model-performance-1.html#cb544-14" tabindex="-1"></a><span class="do">##       neg       pos </span></span>
<span id="cb544-15"><a href="evaluating-model-performance-1.html#cb544-15" tabindex="-1"></a><span class="do">## 0.6666667 0.3333333</span></span>
<span id="cb544-16"><a href="evaluating-model-performance-1.html#cb544-16" tabindex="-1"></a></span>
<span id="cb544-17"><a href="evaluating-model-performance-1.html#cb544-17" tabindex="-1"></a><span class="fu">table</span>(PimaIndiansDiabetes2<span class="sc">$</span>diabetes) <span class="sc">/</span> <span class="fu">nrow</span>(PimaIndiansDiabetes2)</span>
<span id="cb544-18"><a href="evaluating-model-performance-1.html#cb544-18" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb544-19"><a href="evaluating-model-performance-1.html#cb544-19" tabindex="-1"></a><span class="do">##       neg       pos </span></span>
<span id="cb544-20"><a href="evaluating-model-performance-1.html#cb544-20" tabindex="-1"></a><span class="do">## 0.6683673 0.3316327</span></span></code></pre></div>
<p>Now, both proportions are similar to the one in the whole dataset.</p>
<p>While stratified sampling distribute the classes evenly, it does not guarantee other variables are distributed evenly.</p>
<ul>
<li>To mitigate the problem, we can use repeated holdout. That is, we repeat the whole process several times with several random holdout samples and take the average of the performance measures to evaluate the model performance. As multiple holdout samples are used, it is less likely that the model is trained or tested on non-representative data.</li>
</ul>
<div id="cross-validation-1" class="section level3 hasAnchor" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Cross-validation<a href="evaluating-model-performance-1.html#cross-validation-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(k\)</span>-fold cross-validation (<span class="math inline">\(k\)</span>-fold CV) is a procedure in which instead of randomly partition the data many times, we divide the data into <span class="math inline">\(k\)</span> random non-overlapping partitions. Then, we combine <span class="math inline">\(k-1\)</span> partitions to form a training dataset and the remaining one to form the testing dataset. We repeat this procedure <span class="math inline">\(k\)</span> times using different partitions and obtain <span class="math inline">\(k\)</span> evaluations. It is common to use <span class="math inline">\(10\)</span>-fold CV.</p>
<p>For example, when <span class="math inline">\(k=3\)</span>:</p>
<ol style="list-style-type: decimal">
<li>Randomly split your dataset <span class="math inline">\(S\)</span> into <span class="math inline">\(3\)</span> partitions <span class="math inline">\(S_1,S_2,S_3\)</span>.</li>
<li>Use <span class="math inline">\(S_1, S_2\)</span> to train your model. Evaluate the performance using <span class="math inline">\(S_3\)</span>.</li>
<li>Use <span class="math inline">\(S_1, S_3\)</span> to train your model. Evaluate the performance using <span class="math inline">\(S_2\)</span>.</li>
<li>Use <span class="math inline">\(S_2, S_3\)</span> to train your model. Evaluate the performance using <span class="math inline">\(S_1\)</span>.</li>
<li>Report the average of the performance measures obtained in Steps 2-4.</li>
</ol>
<p>See <a href="https://en.wikipedia.org/wiki/File:KfoldCV.gif" class="uri">https://en.wikipedia.org/wiki/File:KfoldCV.gif</a> for a gif animation showing the <span class="math inline">\(k\)</span>-fold CV.</p>
<p>Example:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="evaluating-model-performance-1.html#cb545-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb545-2"><a href="evaluating-model-performance-1.html#cb545-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb545-3"><a href="evaluating-model-performance-1.html#cb545-3" tabindex="-1"></a><span class="co"># the result is a list</span></span>
<span id="cb545-4"><a href="evaluating-model-performance-1.html#cb545-4" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(PimaIndiansDiabetes2<span class="sc">$</span>diabetes, <span class="at">k =</span> k)</span>
<span id="cb545-5"><a href="evaluating-model-performance-1.html#cb545-5" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb545-6"><a href="evaluating-model-performance-1.html#cb545-6" tabindex="-1"></a>AUC <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb545-7"><a href="evaluating-model-performance-1.html#cb545-7" tabindex="-1"></a></span>
<span id="cb545-8"><a href="evaluating-model-performance-1.html#cb545-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb545-9"><a href="evaluating-model-performance-1.html#cb545-9" tabindex="-1"></a>  train_data  <span class="ot">&lt;-</span> PimaIndiansDiabetes2[folds[[i]], ]</span>
<span id="cb545-10"><a href="evaluating-model-performance-1.html#cb545-10" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> PimaIndiansDiabetes2[<span class="sc">-</span>folds[[i]], ]</span>
<span id="cb545-11"><a href="evaluating-model-performance-1.html#cb545-11" tabindex="-1"></a>  fit_simple <span class="ot">&lt;-</span> <span class="fu">glm</span>(diabetes <span class="sc">~</span> glucose, <span class="at">data =</span> train_data, <span class="at">family =</span> binomial)</span>
<span id="cb545-12"><a href="evaluating-model-performance-1.html#cb545-12" tabindex="-1"></a></span>
<span id="cb545-13"><a href="evaluating-model-performance-1.html#cb545-13" tabindex="-1"></a>  <span class="co"># Prediction</span></span>
<span id="cb545-14"><a href="evaluating-model-performance-1.html#cb545-14" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit_simple, test_data, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb545-15"><a href="evaluating-model-performance-1.html#cb545-15" tabindex="-1"></a>  predicted_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">&quot;pos&quot;</span>, <span class="st">&quot;neg&quot;</span>)</span>
<span id="cb545-16"><a href="evaluating-model-performance-1.html#cb545-16" tabindex="-1"></a>  </span>
<span id="cb545-17"><a href="evaluating-model-performance-1.html#cb545-17" tabindex="-1"></a>  <span class="co"># Compute accuracy and AUC</span></span>
<span id="cb545-18"><a href="evaluating-model-performance-1.html#cb545-18" tabindex="-1"></a>  accuracy[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(predicted_class <span class="sc">==</span> test_data<span class="sc">$</span>diabetes)</span>
<span id="cb545-19"><a href="evaluating-model-performance-1.html#cb545-19" tabindex="-1"></a>  AUC[i] <span class="ot">&lt;-</span> <span class="fu">auc</span>(<span class="fu">roc</span>(<span class="at">predictor =</span> <span class="fu">as.numeric</span>(prob), <span class="at">response =</span> test_data<span class="sc">$</span>diabetes))</span>
<span id="cb545-20"><a href="evaluating-model-performance-1.html#cb545-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Results:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="evaluating-model-performance-1.html#cb546-1" tabindex="-1"></a>accuracy</span>
<span id="cb546-2"><a href="evaluating-model-performance-1.html#cb546-2" tabindex="-1"></a><span class="do">##  [1] 0.7733711 0.7535411 0.7705382 0.7698864 0.7535411 0.7535411 0.7563739 0.7620397 0.7443182 0.7705382</span></span>
<span id="cb546-3"><a href="evaluating-model-performance-1.html#cb546-3" tabindex="-1"></a></span>
<span id="cb546-4"><a href="evaluating-model-performance-1.html#cb546-4" tabindex="-1"></a><span class="fu">mean</span>(accuracy)</span>
<span id="cb546-5"><a href="evaluating-model-performance-1.html#cb546-5" tabindex="-1"></a><span class="do">## [1] 0.7607689</span></span>
<span id="cb546-6"><a href="evaluating-model-performance-1.html#cb546-6" tabindex="-1"></a></span>
<span id="cb546-7"><a href="evaluating-model-performance-1.html#cb546-7" tabindex="-1"></a>AUC</span>
<span id="cb546-8"><a href="evaluating-model-performance-1.html#cb546-8" tabindex="-1"></a><span class="do">##  [1] 0.7954331 0.7999783 0.8259271 0.8071468 0.8094126 0.7986021 0.8012821 0.8102455 0.7917803 0.8177061</span></span>
<span id="cb546-9"><a href="evaluating-model-performance-1.html#cb546-9" tabindex="-1"></a></span>
<span id="cb546-10"><a href="evaluating-model-performance-1.html#cb546-10" tabindex="-1"></a><span class="fu">mean</span>(AUC)</span>
<span id="cb546-11"><a href="evaluating-model-performance-1.html#cb546-11" tabindex="-1"></a><span class="do">## [1] 0.8057514</span></span></code></pre></div>
</div>
</div>
<div id="class-imbalance-in-classification" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Class Imbalance in Classification<a href="evaluating-model-performance-1.html#class-imbalance-in-classification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Class imbalance is a common problem in classification where one class (the minority class) has significantly fewer samples than another class (the majority class). This can lead to a biased model that favors the majority class, resulting in poor performance for the minority class. Here are some examples of class imbalance problems in classification:</p>
<ul>
<li><p>Fraud Detection: In a credit card transaction dataset, the number of fraudulent transactions is much lower than the number of legitimate transactions.</p></li>
<li><p>Medical Diagnosis: In a medical diagnosis dataset, the number of positive cases for a rare disease is much lower than the number of negative cases.</p></li>
<li><p>Anomaly Detection: In an anomaly detection dataset, the number of anomalous data points is much lower than the number of normal data points.</p></li>
<li><p>Image Classification: In an image classification dataset, the number of images containing rare objects or events is much lower than the number of images containing common objects or events.</p></li>
</ul>
<p>One popular method to deal wit in classification problems is the SMOTE (Synthetic Minority Over-sampling Technique) algorithm. It works by <strong>generating synthetic samples</strong> for the minority class, which can help balance the class distribution and improve the performance of the model.</p>
<p><strong>SMOTE</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly select an instance from the minority class.</p></li>
<li><p>Randomly select one of the <span class="math inline">\(k\)</span> nearest neighbors of the selected instance and create a new synthetic instance along the line segment between the selected instance and the chosen neighbor <strong>(In this way, the data will not be duplicated but slightly different from the original data.)</strong>. The class label of the synthetic instance is the same as the minority class.</p></li>
<li><p>Repeat this process until the desired number of synthetic samples has been generated.</p></li>
</ol>
<p>Download the archived version of <code>DMwR</code> here: <a href="https://cran.r-project.org/src/contrib/Archive/DMwR/" class="uri">https://cran.r-project.org/src/contrib/Archive/DMwR/</a></p>
<p>You may need to install the package <code>ROCR</code> first. Then, you can install <code>DMwR</code> by clicking Tools -&gt; Install Packages -&gt; Install from: Package archive file -&gt; Browse: choose the file you downloaded above.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="evaluating-model-performance-1.html#cb547-1" tabindex="-1"></a><span class="fu">library</span>(DMwR)</span>
<span id="cb547-2"><a href="evaluating-model-performance-1.html#cb547-2" tabindex="-1"></a></span>
<span id="cb547-3"><a href="evaluating-model-performance-1.html#cb547-3" tabindex="-1"></a><span class="co"># simulated data set</span></span>
<span id="cb547-4"><a href="evaluating-model-performance-1.html#cb547-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">362</span>)</span>
<span id="cb547-5"><a href="evaluating-model-performance-1.html#cb547-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb547-6"><a href="evaluating-model-performance-1.html#cb547-6" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>) <span class="co"># true beta</span></span>
<span id="cb547-7"><a href="evaluating-model-performance-1.html#cb547-7" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb547-8"><a href="evaluating-model-performance-1.html#cb547-8" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb547-9"><a href="evaluating-model-performance-1.html#cb547-9" tabindex="-1"></a>prob_num <span class="ot">&lt;-</span> <span class="fu">exp</span>(beta_0[<span class="dv">1</span>] <span class="sc">+</span> beta_0[<span class="dv">2</span>] <span class="sc">*</span> x1 <span class="sc">+</span> beta_0[<span class="dv">3</span>] <span class="sc">*</span> x2)</span>
<span id="cb547-10"><a href="evaluating-model-performance-1.html#cb547-10" tabindex="-1"></a>prob <span class="ot">&lt;-</span> prob_num <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> prob_num)</span>
<span id="cb547-11"><a href="evaluating-model-performance-1.html#cb547-11" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob)) <span class="co"># the class has to be &quot;factor&quot;</span></span>
<span id="cb547-12"><a href="evaluating-model-performance-1.html#cb547-12" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, x1, x2)</span>
<span id="cb547-13"><a href="evaluating-model-performance-1.html#cb547-13" tabindex="-1"></a></span>
<span id="cb547-14"><a href="evaluating-model-performance-1.html#cb547-14" tabindex="-1"></a><span class="co"># SMOTE</span></span>
<span id="cb547-15"><a href="evaluating-model-performance-1.html#cb547-15" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">SMOTE</span>(y <span class="sc">~</span> ., data, <span class="at">perc.over =</span> <span class="dv">500</span>, <span class="at">perc.under =</span> <span class="dv">200</span>)</span></code></pre></div>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="evaluating-model-performance-1.html#cb548-1" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>y)</span>
<span id="cb548-2"><a href="evaluating-model-performance-1.html#cb548-2" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb548-3"><a href="evaluating-model-performance-1.html#cb548-3" tabindex="-1"></a><span class="do">##   0   1 </span></span>
<span id="cb548-4"><a href="evaluating-model-performance-1.html#cb548-4" tabindex="-1"></a><span class="do">## 894 106</span></span>
<span id="cb548-5"><a href="evaluating-model-performance-1.html#cb548-5" tabindex="-1"></a><span class="fu">table</span>(new_data<span class="sc">$</span>y)</span>
<span id="cb548-6"><a href="evaluating-model-performance-1.html#cb548-6" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb548-7"><a href="evaluating-model-performance-1.html#cb548-7" tabindex="-1"></a><span class="do">##    0    1 </span></span>
<span id="cb548-8"><a href="evaluating-model-performance-1.html#cb548-8" tabindex="-1"></a><span class="do">## 1060  636</span></span></code></pre></div>
<p>Note: Do not generate synthetic data in the test data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="shrinkage-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-c-in-r-with-rcpp.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
