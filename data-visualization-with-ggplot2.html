<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Data Visualization with ggplot2 | STAT 362 R for Data Science</title>
  <meta name="description" content="Notes for STAT 362" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Data Visualization with ggplot2 | STAT 362 R for Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes for STAT 362" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Data Visualization with ggplot2 | STAT 362 R for Data Science" />
  
  <meta name="twitter:description" content="Notes for STAT 362" />
  

<meta name="author" content="Brian Ling" />


<meta name="date" content="2022-03-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-transformation-with-dplyr.html"/>
<link rel="next" href="statistical-inference-in-r.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Data Science</a></li>

<li class="divider"></li>
<li><a href="index.html#syllabus">Syllabus<span></span></a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> What is R and RStudio?<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-will-you-learn-in-this-course"><i class="fa fa-check"></i><b>1.2</b> What will you learn in this course?<span></span></a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#r-and-r-as-a-programming-language"><i class="fa fa-check"></i><b>1.2.1</b> R and R as a programming language<span></span></a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#data-wrangling"><i class="fa fa-check"></i><b>1.2.2</b> Data Wrangling<span></span></a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#data-visualization"><i class="fa fa-check"></i><b>1.2.3</b> Data Visualization<span></span></a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#statistical-inference"><i class="fa fa-check"></i><b>1.2.4</b> Statistical Inference<span></span></a></li>
<li class="chapter" data-level="1.2.5" data-path="introduction.html"><a href="introduction.html#machine-learning"><i class="fa fa-check"></i><b>1.2.5</b> Machine Learning<span></span></a></li>
<li class="chapter" data-level="1.2.6" data-path="introduction.html"><a href="introduction.html#some-numerical-methods"><i class="fa fa-check"></i><b>1.2.6</b> Some Numerical Methods<span></span></a></li>
<li class="chapter" data-level="1.2.7" data-path="introduction.html"><a href="introduction.html#lastly"><i class="fa fa-check"></i><b>1.2.7</b> Lastly<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#lets-get-started"><i class="fa fa-check"></i><b>1.3</b> Let’s Get Started<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#r-data-structures"><i class="fa fa-check"></i><b>1.4</b> R Data Structures<span></span></a><ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#vectors"><i class="fa fa-check"></i><b>1.4.1</b> Vectors<span></span></a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#factors"><i class="fa fa-check"></i><b>1.4.2</b> Factors<span></span></a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#matrix"><i class="fa fa-check"></i><b>1.4.3</b> Matrix<span></span></a></li>
<li class="chapter" data-level="1.4.4" data-path="introduction.html"><a href="introduction.html#lists"><i class="fa fa-check"></i><b>1.4.4</b> Lists<span></span></a></li>
<li class="chapter" data-level="1.4.5" data-path="introduction.html"><a href="introduction.html#data-frames"><i class="fa fa-check"></i><b>1.4.5</b> Data frames<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#operators"><i class="fa fa-check"></i><b>1.5</b> Operators<span></span></a><ul>
<li class="chapter" data-level="1.5.1" data-path="introduction.html"><a href="introduction.html#vectorized-operators"><i class="fa fa-check"></i><b>1.5.1</b> Vectorized Operators<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#built-in-functions"><i class="fa fa-check"></i><b>1.6</b> Built-in Functions<span></span></a><ul>
<li class="chapter" data-level="1.6.1" data-path="introduction.html"><a href="introduction.html#sort"><i class="fa fa-check"></i><b>1.6.1</b> <code>sort()</code><span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction.html"><a href="introduction.html#seq"><i class="fa fa-check"></i><b>1.6.2</b> <code>seq()</code><span></span></a></li>
<li class="chapter" data-level="1.6.3" data-path="introduction.html"><a href="introduction.html#rep"><i class="fa fa-check"></i><b>1.6.3</b> <code>rep()</code><span></span></a></li>
<li class="chapter" data-level="1.6.4" data-path="introduction.html"><a href="introduction.html#pmax-pmin"><i class="fa fa-check"></i><b>1.6.4</b> <code>pmax</code>, <code>pmin</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#some-useful-rstudio-shortcuts"><i class="fa fa-check"></i><b>1.7</b> Some Useful RStudio Shortcuts<span></span></a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.8</b> Exercises<span></span></a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#comments-to-exercises"><i class="fa fa-check"></i><b>1.9</b> Comments to Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>2</b> Probability<span></span></a><ul>
<li class="chapter" data-level="2.1" data-path="probability.html"><a href="probability.html#probability-distributions"><i class="fa fa-check"></i><b>2.1</b> Probability Distributions<span></span></a><ul>
<li class="chapter" data-level="2.1.1" data-path="probability.html"><a href="probability.html#common-distributions"><i class="fa fa-check"></i><b>2.1.1</b> Common Distributions<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="probability.html"><a href="probability.html#exercises-1"><i class="fa fa-check"></i><b>2.1.2</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="probability.html"><a href="probability.html#simulation"><i class="fa fa-check"></i><b>2.2</b> Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="programming-in-r.html"><a href="programming-in-r.html"><i class="fa fa-check"></i><b>3</b> Programming in R<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="programming-in-r.html"><a href="programming-in-r.html#writing-functions-in-r"><i class="fa fa-check"></i><b>3.1</b> Writing functions in R<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="programming-in-r.html"><a href="programming-in-r.html#control-flow"><i class="fa fa-check"></i><b>3.2</b> Control Flow<span></span></a><ul>
<li class="chapter" data-level="3.2.1" data-path="programming-in-r.html"><a href="programming-in-r.html#for-loop"><i class="fa fa-check"></i><b>3.2.1</b> for loop<span></span></a></li>
<li class="chapter" data-level="3.2.2" data-path="programming-in-r.html"><a href="programming-in-r.html#while-loop"><i class="fa fa-check"></i><b>3.2.2</b> while loop<span></span></a></li>
<li class="chapter" data-level="3.2.3" data-path="programming-in-r.html"><a href="programming-in-r.html#if-cond"><i class="fa fa-check"></i><b>3.2.3</b> if (cond)<span></span></a></li>
<li class="chapter" data-level="3.2.4" data-path="programming-in-r.html"><a href="programming-in-r.html#if-cond-else-expr"><i class="fa fa-check"></i><b>3.2.4</b> if (cond) else expr<span></span></a></li>
<li class="chapter" data-level="3.2.5" data-path="programming-in-r.html"><a href="programming-in-r.html#if-else-ladder"><i class="fa fa-check"></i><b>3.2.5</b> If else ladder<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="programming-in-r.html"><a href="programming-in-r.html#automatically-reindent-code"><i class="fa fa-check"></i><b>3.3</b> Automatically Reindent Code<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="programming-in-r.html"><a href="programming-in-r.html#speed-consideration"><i class="fa fa-check"></i><b>3.4</b> Speed Consideration<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="programming-in-r.html"><a href="programming-in-r.html#another-simulation-example"><i class="fa fa-check"></i><b>3.5</b> Another Simulation Example<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html"><i class="fa fa-check"></i><b>4</b> Creating Some Basic Plots<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#scatter-plot"><i class="fa fa-check"></i><b>4.1</b> Scatter Plot<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#line-graph"><i class="fa fa-check"></i><b>4.2</b> Line Graph<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#bar-chart"><i class="fa fa-check"></i><b>4.3</b> Bar Chart<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#histogram"><i class="fa fa-check"></i><b>4.4</b> Histogram<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#box-plot"><i class="fa fa-check"></i><b>4.5</b> Box Plot<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#plotting-a-function-curve"><i class="fa fa-check"></i><b>4.6</b> Plotting a function curve<span></span></a></li>
<li class="chapter" data-level="4.7" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#more-on-plots-with-base-r"><i class="fa fa-check"></i><b>4.7</b> More on plots with base R<span></span></a><ul>
<li class="chapter" data-level="4.7.1" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#multi-frame-plot"><i class="fa fa-check"></i><b>4.7.1</b> Multi-frame plot<span></span></a></li>
<li class="chapter" data-level="4.7.2" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#subsubsec:type_of_plot"><i class="fa fa-check"></i><b>4.7.2</b> Type of Plot<span></span></a></li>
<li class="chapter" data-level="4.7.3" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#parameters-of-a-plot"><i class="fa fa-check"></i><b>4.7.3</b> Parameters of a plot<span></span></a></li>
<li class="chapter" data-level="4.7.4" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#elements-on-plot"><i class="fa fa-check"></i><b>4.7.4</b> Elements on plot<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="creating-some-basic-plots.html"><a href="creating-some-basic-plots.html#summary-of-ggplot"><i class="fa fa-check"></i><b>4.8</b> Summary of <code>ggplot</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html"><i class="fa fa-check"></i><b>5</b> Managing Data with R<span></span></a><ul>
<li class="chapter" data-level="5.1" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#missing-values"><i class="fa fa-check"></i><b>5.1</b> Missing Values<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#saving-loading-and-removing-r-data-structures"><i class="fa fa-check"></i><b>5.2</b> Saving, loading, and removing R data structures<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="managing-data-with-r.html"><a href="managing-data-with-r.html#importing-and-saving-data-from-csv-files"><i class="fa fa-check"></i><b>5.3</b> Importing and saving data from CSV files<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="review-chapter-1-5.html"><a href="review-chapter-1-5.html"><i class="fa fa-check"></i><b>6</b> Review (Chapter 1-5)<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="review-chapter-1-5.html"><a href="review-chapter-1-5.html#simulation-1"><i class="fa fa-check"></i><b>6.1</b> Simulation<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="review-chapter-1-5.html"><a href="review-chapter-1-5.html#matrix-1"><i class="fa fa-check"></i><b>6.2</b> Matrix<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="review-chapter-1-5.html"><a href="review-chapter-1-5.html#basic-operation"><i class="fa fa-check"></i><b>6.3</b> Basic Operation<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="review-chapter-1-5.html"><a href="review-chapter-1-5.html#some-basic-plots-in-r"><i class="fa fa-check"></i><b>6.4</b> Some basic plots in R<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html"><i class="fa fa-check"></i><b>7</b> Data Transformation with <code>dplyr</code><span></span></a><ul>
<li class="chapter" data-level="7.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#introduction-1"><i class="fa fa-check"></i><b>7.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#arrange"><i class="fa fa-check"></i><b>7.2</b> <code>arrange()</code><span></span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#exercises-2"><i class="fa fa-check"></i><b>7.2.1</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#filter"><i class="fa fa-check"></i><b>7.3</b> <code>filter()</code><span></span></a><ul>
<li class="chapter" data-level="7.3.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#exercises-3"><i class="fa fa-check"></i><b>7.3.1</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#select"><i class="fa fa-check"></i><b>7.4</b> <code>select()</code><span></span></a><ul>
<li class="chapter" data-level="7.4.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#exercises-4"><i class="fa fa-check"></i><b>7.4.1</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#mutate"><i class="fa fa-check"></i><b>7.5</b> <code>mutate()</code><span></span></a><ul>
<li class="chapter" data-level="7.5.1" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#exercises-5"><i class="fa fa-check"></i><b>7.5.1</b> Exercises<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#summarize-group_by"><i class="fa fa-check"></i><b>7.6</b> <code>summarize(), group_by()</code><span></span></a></li>
<li class="chapter" data-level="7.7" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#combining-multiple-operations-with-pipe"><i class="fa fa-check"></i><b>7.7</b> Combining Multiple Operations with Pipe <code>%&gt;%</code><span></span></a></li>
<li class="chapter" data-level="7.8" data-path="data-transformation-with-dplyr.html"><a href="data-transformation-with-dplyr.html#summary"><i class="fa fa-check"></i><b>7.8</b> Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html"><i class="fa fa-check"></i><b>8</b> Data Visualization with ggplot2<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#bar-charts"><i class="fa fa-check"></i><b>8.1</b> Bar charts<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#line-graph-1"><i class="fa fa-check"></i><b>8.2</b> Line Graph<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#scatter-plots"><i class="fa fa-check"></i><b>8.3</b> Scatter Plots<span></span></a><ul>
<li class="chapter" data-level="8.3.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#overplotting"><i class="fa fa-check"></i><b>8.3.1</b> Overplotting<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#labelling-points-in-a-scatter-plot"><i class="fa fa-check"></i><b>8.3.2</b> Labelling points in a scatter plot<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#summarizing-data-distributions"><i class="fa fa-check"></i><b>8.4</b> Summarizing Data Distributions<span></span></a><ul>
<li class="chapter" data-level="8.4.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#histogram-1"><i class="fa fa-check"></i><b>8.4.1</b> Histogram<span></span></a></li>
<li class="chapter" data-level="8.4.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#kernel-density-estimate"><i class="fa fa-check"></i><b>8.4.2</b> Kernel Density Estimate<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#saving-your-plots"><i class="fa fa-check"></i><b>8.5</b> Saving your plots<span></span></a><ul>
<li class="chapter" data-level="8.5.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#outputting-to-pdf-vector-files"><i class="fa fa-check"></i><b>8.5.1</b> Outputting to pdf vector files<span></span></a></li>
<li class="chapter" data-level="8.5.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#outputting-to-bitmap-files"><i class="fa fa-check"></i><b>8.5.2</b> Outputting to bitmap files<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#summary-1"><i class="fa fa-check"></i><b>8.6</b> Summary<span></span></a><ul>
<li class="chapter" data-level="8.6.1" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#combining-multiple-operations-with-pipe-1"><i class="fa fa-check"></i><b>8.6.1</b> Combining multiple operations with pipe <code>%&gt;%</code><span></span></a></li>
<li class="chapter" data-level="8.6.2" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#bar-charts-1"><i class="fa fa-check"></i><b>8.6.2</b> Bar charts<span></span></a></li>
<li class="chapter" data-level="8.6.3" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#line-graphs"><i class="fa fa-check"></i><b>8.6.3</b> Line graphs<span></span></a></li>
<li class="chapter" data-level="8.6.4" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#scatter-plot-1"><i class="fa fa-check"></i><b>8.6.4</b> Scatter plot<span></span></a></li>
<li class="chapter" data-level="8.6.5" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#summarizing-data-distributions-1"><i class="fa fa-check"></i><b>8.6.5</b> Summarizing data distributions<span></span></a></li>
<li class="chapter" data-level="8.6.6" data-path="data-visualization-with-ggplot2.html"><a href="data-visualization-with-ggplot2.html#saving-your-plots-1"><i class="fa fa-check"></i><b>8.6.6</b> Saving your plots<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html"><i class="fa fa-check"></i><b>9</b> Statistical Inference in R<span></span></a><ul>
<li class="chapter" data-level="9.1" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>9.1</b> Maximum Likelihood Estimation<span></span></a><ul>
<li class="chapter" data-level="9.1.1" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#exercises-on-mle"><i class="fa fa-check"></i><b>9.1.1</b> Exercises on MLE<span></span></a></li>
<li class="chapter" data-level="9.1.2" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#summary-2"><i class="fa fa-check"></i><b>9.1.2</b> Summary<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#interval-estimation-and-hypothesis-testing"><i class="fa fa-check"></i><b>9.2</b> Interval Estimation and Hypothesis Testing<span></span></a><ul>
<li class="chapter" data-level="9.2.1" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#examples-of-hypothesis-testing"><i class="fa fa-check"></i><b>9.2.1</b> Examples of Hypothesis Testing<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#null-hypotheses-alternative-hypotheses-and-p-values"><i class="fa fa-check"></i><b>9.2.2</b> Null Hypotheses, Alternative Hypotheses, and p-values<span></span></a></li>
<li class="chapter" data-level="9.2.3" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#type-i-error-and-type-ii-error"><i class="fa fa-check"></i><b>9.2.3</b> Type I error and Type II error<span></span></a></li>
<li class="chapter" data-level="9.2.4" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#inference-for-mean-of-one-sample"><i class="fa fa-check"></i><b>9.2.4</b> Inference for Mean of One Sample<span></span></a></li>
<li class="chapter" data-level="9.2.5" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#comparing-the-means-of-two-samples"><i class="fa fa-check"></i><b>9.2.5</b> Comparing the means of two samples<span></span></a></li>
<li class="chapter" data-level="9.2.6" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#inference-of-a-sample-proportion"><i class="fa fa-check"></i><b>9.2.6</b> Inference of a Sample Proportion<span></span></a></li>
<li class="chapter" data-level="9.2.7" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#testing-groups-for-equal-proportions"><i class="fa fa-check"></i><b>9.2.7</b> Testing groups for equal proportions<span></span></a></li>
<li class="chapter" data-level="9.2.8" data-path="statistical-inference-in-r.html"><a href="statistical-inference-in-r.html#testing-if-two-samples-have-the-same-underlying-distribution"><i class="fa fa-check"></i><b>9.2.8</b> Testing if two samples have the same underlying distribution<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html"><i class="fa fa-check"></i><b>10</b> Root finding and optimization<span></span></a><ul>
<li class="chapter" data-level="10.1" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#root-finding"><i class="fa fa-check"></i><b>10.1</b> Root Finding<span></span></a><ul>
<li class="chapter" data-level="10.1.1" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#bisection-method"><i class="fa fa-check"></i><b>10.1.1</b> Bisection Method<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#newton-raphson-method"><i class="fa fa-check"></i><b>10.2</b> Newton-Raphson Method<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#minimization-and-maximization"><i class="fa fa-check"></i><b>10.3</b> Minimization and Maximization<span></span></a><ul>
<li class="chapter" data-level="10.3.1" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#newton-raphson-method-1"><i class="fa fa-check"></i><b>10.3.1</b> Newton-Raphson Method<span></span></a></li>
<li class="chapter" data-level="10.3.2" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#gradient-descent"><i class="fa fa-check"></i><b>10.3.2</b> Gradient Descent<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="root-finding-and-optimization.html"><a href="root-finding-and-optimization.html#optim"><i class="fa fa-check"></i><b>10.4</b> <code>optim</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html"><i class="fa fa-check"></i><b>11</b> k-nearest neighbors<span></span></a><ul>
<li class="chapter" data-level="11.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#introduction-2"><i class="fa fa-check"></i><b>11.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="11.2" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#feature-scaling"><i class="fa fa-check"></i><b>11.2</b> Feature Scaling<span></span></a></li>
<li class="chapter" data-level="11.3" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#example-classifying-breast-cancers"><i class="fa fa-check"></i><b>11.3</b> Example: Classifying Breast Cancers<span></span></a><ul>
<li class="chapter" data-level="11.3.1" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#evaluating-model-performance"><i class="fa fa-check"></i><b>11.3.1</b> Evaluating Model Performance<span></span></a></li>
<li class="chapter" data-level="11.3.2" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#using-z-score-standardization"><i class="fa fa-check"></i><b>11.3.2</b> Using <span class="math inline">\(z\)</span>-score standardization<span></span></a></li>
<li class="chapter" data-level="11.3.3" data-path="k-nearest-neighbors.html"><a href="k-nearest-neighbors.html#testing-alternative-values-of-k"><i class="fa fa-check"></i><b>11.3.3</b> Testing alternative values of <span class="math inline">\(k\)</span><span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="linear-regression-models.html"><a href="linear-regression-models.html"><i class="fa fa-check"></i><b>12</b> Linear Regression Models<span></span></a><ul>
<li class="chapter" data-level="12.1" data-path="linear-regression-models.html"><a href="linear-regression-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>12.1</b> Simple Linear Regression<span></span></a></li>
<li class="chapter" data-level="12.2" data-path="linear-regression-models.html"><a href="linear-regression-models.html#smoothed-conditional-means"><i class="fa fa-check"></i><b>12.2</b> Smoothed Conditional Means<span></span></a></li>
<li class="chapter" data-level="12.3" data-path="linear-regression-models.html"><a href="linear-regression-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>12.3</b> Multiple Linear Regression<span></span></a></li>
<li class="chapter" data-level="12.4" data-path="linear-regression-models.html"><a href="linear-regression-models.html#example-diamonds"><i class="fa fa-check"></i><b>12.4</b> Example: <code>diamonds</code><span></span></a></li>
<li class="chapter" data-level="12.5" data-path="linear-regression-models.html"><a href="linear-regression-models.html#categorical-predictors"><i class="fa fa-check"></i><b>12.5</b> Categorical Predictors<span></span></a></li>
<li class="chapter" data-level="12.6" data-path="linear-regression-models.html"><a href="linear-regression-models.html#compare-models-using-anova"><i class="fa fa-check"></i><b>12.6</b> Compare models using ANOVA<span></span></a></li>
<li class="chapter" data-level="12.7" data-path="linear-regression-models.html"><a href="linear-regression-models.html#prediction"><i class="fa fa-check"></i><b>12.7</b> Prediction<span></span></a></li>
<li class="chapter" data-level="12.8" data-path="linear-regression-models.html"><a href="linear-regression-models.html#interaction-terms"><i class="fa fa-check"></i><b>12.8</b> Interaction Terms<span></span></a></li>
<li class="chapter" data-level="12.9" data-path="linear-regression-models.html"><a href="linear-regression-models.html#variable-transformation"><i class="fa fa-check"></i><b>12.9</b> Variable Transformation<span></span></a></li>
<li class="chapter" data-level="12.10" data-path="linear-regression-models.html"><a href="linear-regression-models.html#polynomial-regression"><i class="fa fa-check"></i><b>12.10</b> Polynomial Regression<span></span></a></li>
<li class="chapter" data-level="12.11" data-path="linear-regression-models.html"><a href="linear-regression-models.html#stepwise-regression"><i class="fa fa-check"></i><b>12.11</b> Stepwise regression<span></span></a></li>
<li class="chapter" data-level="12.12" data-path="linear-regression-models.html"><a href="linear-regression-models.html#best-subset"><i class="fa fa-check"></i><b>12.12</b> Best subset<span></span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="logistic-regression-model.html"><a href="logistic-regression-model.html"><i class="fa fa-check"></i><b>13</b> Logistic Regression Model<span></span></a></li>
<li class="chapter" data-level="14" data-path="k-means-clustering.html"><a href="k-means-clustering.html"><i class="fa fa-check"></i><b>14</b> k-means Clustering<span></span></a><ul>
<li class="chapter" data-level="14.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#introduction-3"><i class="fa fa-check"></i><b>14.1</b> Introduction<span></span></a></li>
<li class="chapter" data-level="14.2" data-path="k-means-clustering.html"><a href="k-means-clustering.html#applications"><i class="fa fa-check"></i><b>14.2</b> Applications<span></span></a><ul>
<li class="chapter" data-level="14.2.1" data-path="k-means-clustering.html"><a href="k-means-clustering.html#cluster-analysis"><i class="fa fa-check"></i><b>14.2.1</b> Cluster Analysis<span></span></a></li>
<li class="chapter" data-level="14.2.2" data-path="k-means-clustering.html"><a href="k-means-clustering.html#image-segementation-and-image-compression"><i class="fa fa-check"></i><b>14.2.2</b> Image Segementation and Image Compression<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html"><i class="fa fa-check"></i><b>15</b> Hierarchical Clustering<span></span></a><ul>
<li class="chapter" data-level="15.1" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#dissimilarity-measure-and-linkage"><i class="fa fa-check"></i><b>15.1</b> Dissimilarity measure and Linkage<span></span></a></li>
<li class="chapter" data-level="15.2" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#alogrithm"><i class="fa fa-check"></i><b>15.2</b> Alogrithm<span></span></a></li>
<li class="chapter" data-level="15.3" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#applications-1"><i class="fa fa-check"></i><b>15.3</b> Applications<span></span></a><ul>
<li class="chapter" data-level="15.3.1" data-path="hierarchical-clustering.html"><a href="hierarchical-clustering.html#nci60-data"><i class="fa fa-check"></i><b>15.3.1</b> NCI60 Data<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>16</b> Resampling Methods<span></span></a><ul>
<li class="chapter" data-level="16.1" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation"><i class="fa fa-check"></i><b>16.1</b> Cross-validation<span></span></a><ul>
<li class="chapter" data-level="16.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#cv-in-glm"><i class="fa fa-check"></i><b>16.1.1</b> CV in GLM<span></span></a></li>
<li class="chapter" data-level="16.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#general-implementation"><i class="fa fa-check"></i><b>16.1.2</b> General Implementation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap"><i class="fa fa-check"></i><b>16.2</b> Bootstrap<span></span></a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>17</b> Regularization<span></span></a><ul>
<li class="chapter" data-level="17.1" data-path="regularization.html"><a href="regularization.html#ridge-regression"><i class="fa fa-check"></i><b>17.1</b> Ridge Regression<span></span></a></li>
<li class="chapter" data-level="17.2" data-path="regularization.html"><a href="regularization.html#lasso"><i class="fa fa-check"></i><b>17.2</b> LASSO<span></span></a></li>
<li class="chapter" data-level="17.3" data-path="regularization.html"><a href="regularization.html#selecting-the-tuning-parameter"><i class="fa fa-check"></i><b>17.3</b> Selecting the tuning parameter<span></span></a></li>
<li class="chapter" data-level="17.4" data-path="regularization.html"><a href="regularization.html#glmnet"><i class="fa fa-check"></i><b>17.4</b> <code>glmnet</code><span></span></a><ul>
<li class="chapter" data-level="17.4.1" data-path="regularization.html"><a href="regularization.html#ridge-regression-1"><i class="fa fa-check"></i><b>17.4.1</b> Ridge Regression<span></span></a></li>
<li class="chapter" data-level="17.4.2" data-path="regularization.html"><a href="regularization.html#lasso-1"><i class="fa fa-check"></i><b>17.4.2</b> LASSO<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="decision-tree.html"><a href="decision-tree.html"><i class="fa fa-check"></i><b>18</b> Decision Tree<span></span></a></li>
<li class="chapter" data-level="19" data-path="ensemble-methods.html"><a href="ensemble-methods.html"><i class="fa fa-check"></i><b>19</b> Ensemble Methods<span></span></a><ul>
<li class="chapter" data-level="19.1" data-path="ensemble-methods.html"><a href="ensemble-methods.html#bagging"><i class="fa fa-check"></i><b>19.1</b> Bagging<span></span></a></li>
<li class="chapter" data-level="19.2" data-path="ensemble-methods.html"><a href="ensemble-methods.html#random-forest"><i class="fa fa-check"></i><b>19.2</b> Random Forest<span></span></a></li>
<li class="chapter" data-level="19.3" data-path="ensemble-methods.html"><a href="ensemble-methods.html#boosting"><i class="fa fa-check"></i><b>19.3</b> Boosting<span></span></a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="deep-learning.html"><a href="deep-learning.html"><i class="fa fa-check"></i><b>20</b> Deep Learning<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 362 R for Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization-with-ggplot2" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 8</span> Data Visualization with ggplot2<a href="data-visualization-with-ggplot2.html#data-visualization-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Main reference for this chapter: R graphics cookbook (<a href="https://r-graphics.org/" class="uri">https://r-graphics.org/</a>)</p>
<p>In Chapter 4, we learned how to create some basic plots with base R and the function ggplot (in the package ggplot2, which is also contained in the package tidyverse). In this chapter, we will study how to use ggplot for data visualization in more detail.</p>
<p>We will use some of the datasets from the the package gcookbook. Therefore, we will install it now.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="data-visualization-with-ggplot2.html#cb247-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;gcookbook&quot;</span>)</span></code></pre></div>
<p>Load the packages gcookbook, tidyverse and nycflights13.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="data-visualization-with-ggplot2.html#cb248-1"></a><span class="kw">library</span>(gcookbook) <span class="co"># contains some datasets for illustration</span></span>
<span id="cb248-2"><a href="data-visualization-with-ggplot2.html#cb248-2"></a><span class="kw">library</span>(tidyverse) <span class="co"># contains ggplot2 and dplyr</span></span>
<span id="cb248-3"><a href="data-visualization-with-ggplot2.html#cb248-3"></a><span class="kw">library</span>(nycflights13) <span class="co"># contains the dataset &quot;flights&quot;</span></span></code></pre></div>
<div id="bar-charts" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.1</span> Bar charts<a href="data-visualization-with-ggplot2.html#bar-charts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will start with bar charts. Many of the usages discussed in this section can also be transferable to create other plots.</p>
<p>Recall that there are two types of bar charts:</p>
<ol style="list-style-type: decimal">
<li>Bar chart of values. x-axis: discrete variable, y-axis: numeric data (not necessarily count data)</li>
<li>Bar chart of counts. x-axis: discrete variable, y-axis: count of cases in the discrete variable</li>
</ol>
<p>Using ggplot:</p>
<ol style="list-style-type: decimal">
<li>For bar chart of values, we use <code>geom_col()</code>, which is the same as using <code>geom_bar(stat = "identity")</code>.</li>
<li>For bar chart of counts, we use <code>geom_bar()</code>, which is the same as using <code>geom_bar(stat = "count")</code>. That is, the default for <code>geom_bar()</code> is to use <code>stat = "count"</code>.</li>
</ol>
<p><strong>Bar chart of values</strong>:</p>
<p><code>pg_mean</code> is a simple dataset with groupwise means of some plant growth data.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="data-visualization-with-ggplot2.html#cb249-1"></a>pg_mean</span>
<span id="cb249-2"><a href="data-visualization-with-ggplot2.html#cb249-2"></a><span class="co">##   group weight</span></span>
<span id="cb249-3"><a href="data-visualization-with-ggplot2.html#cb249-3"></a><span class="co">## 1  ctrl  5.032</span></span>
<span id="cb249-4"><a href="data-visualization-with-ggplot2.html#cb249-4"></a><span class="co">## 2  trt1  4.661</span></span>
<span id="cb249-5"><a href="data-visualization-with-ggplot2.html#cb249-5"></a><span class="co">## 3  trt2  5.526</span></span></code></pre></div>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="data-visualization-with-ggplot2.html#cb250-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> pg_mean, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> weight)) <span class="op">+</span></span>
<span id="cb250-2"><a href="data-visualization-with-ggplot2.html#cb250-2"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-279-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Recall the <code>mtcars</code> dataset. Let’s create a bar chart of values for the mean weights grouped by the number of gears. First, we summarize the data using <code>summarize</code>.</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="data-visualization-with-ggplot2.html#cb251-1"></a>by_gear &lt;-<span class="st"> </span><span class="kw">group_by</span>(mtcars, gear)</span>
<span id="cb251-2"><a href="data-visualization-with-ggplot2.html#cb251-2"></a>mtcars_wt &lt;-<span class="st"> </span><span class="kw">summarize</span>(by_gear, <span class="dt">mean_wt_by_gear =</span> <span class="kw">mean</span>(wt))</span>
<span id="cb251-3"><a href="data-visualization-with-ggplot2.html#cb251-3"></a></span>
<span id="cb251-4"><a href="data-visualization-with-ggplot2.html#cb251-4"></a><span class="co"># Alternatively, using %&gt;%</span></span>
<span id="cb251-5"><a href="data-visualization-with-ggplot2.html#cb251-5"></a>mtcars_wt &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb251-6"><a href="data-visualization-with-ggplot2.html#cb251-6"></a><span class="st">  </span><span class="kw">group_by</span>(gear) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb251-7"><a href="data-visualization-with-ggplot2.html#cb251-7"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_wt_by_gear =</span> <span class="kw">mean</span>(wt))</span></code></pre></div>
<p>Create the bar chart:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="data-visualization-with-ggplot2.html#cb252-1"></a><span class="kw">ggplot</span>(mtcars_wt, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt_by_gear)) <span class="op">+</span></span>
<span id="cb252-2"><a href="data-visualization-with-ggplot2.html#cb252-2"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-281-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>To change the colour of the bars, use <code>fill</code>.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="data-visualization-with-ggplot2.html#cb253-1"></a><span class="kw">ggplot</span>(mtcars_wt, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt_by_gear)) <span class="op">+</span></span>
<span id="cb253-2"><a href="data-visualization-with-ggplot2.html#cb253-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-282-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>By default, there is no outline around the fill. To add an outline, use <code>colour</code> (or <code>color</code>).</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="data-visualization-with-ggplot2.html#cb254-1"></a><span class="kw">ggplot</span>(mtcars_wt, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt_by_gear)) <span class="op">+</span></span>
<span id="cb254-2"><a href="data-visualization-with-ggplot2.html#cb254-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-283-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Of course, you can combine the two settings:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="data-visualization-with-ggplot2.html#cb255-1"></a><span class="kw">ggplot</span>(mtcars_wt, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt_by_gear)) <span class="op">+</span></span>
<span id="cb255-2"><a href="data-visualization-with-ggplot2.html#cb255-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-284-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Graph with grouped bars</strong></p>
<p>The most basic bar chart of values have one categorical variable on the x-axis and one continuous variable on the y-axis. If you want to <strong>include another categorical variable</strong> to divide up the data, you can use a graph with grouped bars.</p>
<p>In <code>mtcars</code>, <code>vs</code> represents the engine of the car with 0 = V-shaped and 1 = straight. We can use <code>vc</code> to divide up the data in addition to <code>gear</code> using <code>fill</code>. To create a grouped bar chart, set <code>position = "dodge"</code> in <code>geom_col()</code>; otherwise, you will get a stacked bar chart.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="data-visualization-with-ggplot2.html#cb256-1"></a><span class="co"># prepare the data</span></span>
<span id="cb256-2"><a href="data-visualization-with-ggplot2.html#cb256-2"></a>by_gear_vs &lt;-<span class="st"> </span><span class="kw">group_by</span>(mtcars, gear, vs)</span>
<span id="cb256-3"><a href="data-visualization-with-ggplot2.html#cb256-3"></a>mtcars_wt2 &lt;-<span class="st"> </span><span class="kw">summarize</span>(by_gear_vs, <span class="dt">mean_wt =</span> <span class="kw">mean</span>(wt))</span>
<span id="cb256-4"><a href="data-visualization-with-ggplot2.html#cb256-4"></a><span class="co"># convert to factor in the data</span></span>
<span id="cb256-5"><a href="data-visualization-with-ggplot2.html#cb256-5"></a>mtcars_wt2<span class="op">$</span>vs &lt;-<span class="st"> </span><span class="kw">as.factor</span>(mtcars_wt2<span class="op">$</span>vs) </span>
<span id="cb256-6"><a href="data-visualization-with-ggplot2.html#cb256-6"></a></span>
<span id="cb256-7"><a href="data-visualization-with-ggplot2.html#cb256-7"></a><span class="co"># using pipe %&gt;% to prepare the data</span></span>
<span id="cb256-8"><a href="data-visualization-with-ggplot2.html#cb256-8"></a>mtcars_wt2 &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-9"><a href="data-visualization-with-ggplot2.html#cb256-9"></a><span class="st">  </span><span class="kw">group_by</span>(gear, vs) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-10"><a href="data-visualization-with-ggplot2.html#cb256-10"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_wt =</span> <span class="kw">mean</span>(wt)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-11"><a href="data-visualization-with-ggplot2.html#cb256-11"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb256-12"><a href="data-visualization-with-ggplot2.html#cb256-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vs =</span> <span class="kw">as.factor</span>(vs))</span>
<span id="cb256-13"><a href="data-visualization-with-ggplot2.html#cb256-13"></a></span>
<span id="cb256-14"><a href="data-visualization-with-ggplot2.html#cb256-14"></a><span class="co"># plot</span></span>
<span id="cb256-15"><a href="data-visualization-with-ggplot2.html#cb256-15"></a><span class="kw">ggplot</span>(mtcars_wt2, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt, <span class="dt">fill =</span> vs)) <span class="op">+</span></span>
<span id="cb256-16"><a href="data-visualization-with-ggplot2.html#cb256-16"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-285-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Without <code>position = "dodge"</code>, we get a stacked bar chart:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="data-visualization-with-ggplot2.html#cb257-1"></a><span class="kw">ggplot</span>(mtcars_wt2, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt, <span class="dt">fill =</span> vs)) <span class="op">+</span></span>
<span id="cb257-2"><a href="data-visualization-with-ggplot2.html#cb257-2"></a><span class="st">  </span><span class="kw">geom_col</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-286-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can also convert <code>vs</code> to factor in call to <code>ggplot()</code>:</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="data-visualization-with-ggplot2.html#cb258-1"></a><span class="co"># prepare the data</span></span>
<span id="cb258-2"><a href="data-visualization-with-ggplot2.html#cb258-2"></a>by_gear_vs &lt;-<span class="st"> </span><span class="kw">group_by</span>(mtcars, gear, vs)</span>
<span id="cb258-3"><a href="data-visualization-with-ggplot2.html#cb258-3"></a>mtcars_wt3 &lt;-<span class="st"> </span><span class="kw">summarize</span>(by_gear_vs, <span class="dt">mean_wt =</span> <span class="kw">mean</span>(wt))</span>
<span id="cb258-4"><a href="data-visualization-with-ggplot2.html#cb258-4"></a></span>
<span id="cb258-5"><a href="data-visualization-with-ggplot2.html#cb258-5"></a><span class="co"># plot</span></span>
<span id="cb258-6"><a href="data-visualization-with-ggplot2.html#cb258-6"></a><span class="kw">ggplot</span>(mtcars_wt3, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt, <span class="dt">fill =</span> <span class="kw">factor</span>(vs))) <span class="op">+</span></span>
<span id="cb258-7"><a href="data-visualization-with-ggplot2.html#cb258-7"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p>To change the colours of the bars:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="data-visualization-with-ggplot2.html#cb259-1"></a><span class="kw">ggplot</span>(mtcars_wt2, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt, <span class="dt">fill =</span> vs)) <span class="op">+</span></span>
<span id="cb259-2"><a href="data-visualization-with-ggplot2.html#cb259-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb259-3"><a href="data-visualization-with-ggplot2.html#cb259-3"></a><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Pastel2&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-288-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can try with different palettes:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="data-visualization-with-ggplot2.html#cb260-1"></a><span class="kw">library</span>(RColorBrewer)</span>
<span id="cb260-2"><a href="data-visualization-with-ggplot2.html#cb260-2"></a><span class="kw">display.brewer.all</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-289-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Using <code>palette = "Oranges"</code>:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="data-visualization-with-ggplot2.html#cb261-1"></a><span class="kw">ggplot</span>(mtcars_wt2, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt, <span class="dt">fill =</span> vs)) <span class="op">+</span></span>
<span id="cb261-2"><a href="data-visualization-with-ggplot2.html#cb261-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb261-3"><a href="data-visualization-with-ggplot2.html#cb261-3"></a><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Oranges&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-290-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Using a manually defined palette:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="data-visualization-with-ggplot2.html#cb262-1"></a><span class="kw">ggplot</span>(mtcars_wt2, <span class="kw">aes</span>(<span class="dt">x =</span> gear, <span class="dt">y =</span> mean_wt, <span class="dt">fill =</span> vs)) <span class="op">+</span></span>
<span id="cb262-2"><a href="data-visualization-with-ggplot2.html#cb262-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb262-3"><a href="data-visualization-with-ggplot2.html#cb262-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#cc6666&quot;</span>, <span class="st">&quot;#66cccc&quot;</span>)) <span class="co"># also see Section 4.2 for the color</span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-291-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Bar Charts of Counts</strong></p>
<p>Creating a bar chart of counts is very similar to creating a bar chart of values.</p>
<p>Bar chart of the number of cars by gear in <code>mtcars</code>:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="data-visualization-with-ggplot2.html#cb263-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> gear)) <span class="op">+</span></span>
<span id="cb263-2"><a href="data-visualization-with-ggplot2.html#cb263-2"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-292-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Bar chart of the number of flights by each month in <code>nycflights13</code>:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="data-visualization-with-ggplot2.html#cb264-1"></a><span class="kw">ggplot</span>(flights, <span class="kw">aes</span>(<span class="dt">x =</span> month)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb264-2"><a href="data-visualization-with-ggplot2.html#cb264-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></span>
<span id="cb264-3"><a href="data-visualization-with-ggplot2.html#cb264-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="co"># change the labels</span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-293-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Controlling the width (by default, <code>width = 0.9</code>):</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="data-visualization-with-ggplot2.html#cb265-1"></a><span class="co"># if we use change the month to factor(month)</span></span>
<span id="cb265-2"><a href="data-visualization-with-ggplot2.html#cb265-2"></a><span class="co"># the labels are corrects</span></span>
<span id="cb265-3"><a href="data-visualization-with-ggplot2.html#cb265-3"></a><span class="kw">ggplot</span>(flights, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">factor</span>(month))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb265-4"><a href="data-visualization-with-ggplot2.html#cb265-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">width =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb265-5"><a href="data-visualization-with-ggplot2.html#cb265-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;month&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-294-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Bar chart of the number of flights by origin and month:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="data-visualization-with-ggplot2.html#cb266-1"></a><span class="co"># have to convert month to factor</span></span>
<span id="cb266-2"><a href="data-visualization-with-ggplot2.html#cb266-2"></a><span class="kw">ggplot</span>(flights, <span class="kw">aes</span>(<span class="dt">x =</span> origin, <span class="dt">fill =</span> <span class="kw">factor</span>(month))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb266-3"><a href="data-visualization-with-ggplot2.html#cb266-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb266-4"><a href="data-visualization-with-ggplot2.html#cb266-4"></a><span class="st">  </span><span class="kw">scale_fill_discrete</span>(<span class="dt">name =</span> <span class="st">&quot;Month&quot;</span>) <span class="co"># change the title of the legend</span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-295-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="line-graph-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.2</span> Line Graph<a href="data-visualization-with-ggplot2.html#line-graph-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose you want to make a <strong>line graph</strong> of the daily average departure delay in <code>flights</code>. From now on, we will use <code>%&gt;%</code> whenever it is appropriate.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="data-visualization-with-ggplot2.html#cb267-1"></a>avg_delay &lt;-<span class="st"> </span></span>
<span id="cb267-2"><a href="data-visualization-with-ggplot2.html#cb267-2"></a><span class="st">  </span>flights <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-3"><a href="data-visualization-with-ggplot2.html#cb267-3"></a><span class="st">  </span><span class="kw">group_by</span>(month, day) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-4"><a href="data-visualization-with-ggplot2.html#cb267-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-5"><a href="data-visualization-with-ggplot2.html#cb267-5"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb267-6"><a href="data-visualization-with-ggplot2.html#cb267-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Time =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">365</span>) </span>
<span id="cb267-7"><a href="data-visualization-with-ggplot2.html#cb267-7"></a></span>
<span id="cb267-8"><a href="data-visualization-with-ggplot2.html#cb267-8"></a></span>
<span id="cb267-9"><a href="data-visualization-with-ggplot2.html#cb267-9"></a></span>
<span id="cb267-10"><a href="data-visualization-with-ggplot2.html#cb267-10"></a><span class="kw">ggplot</span>(avg_delay, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> delay)) <span class="op">+</span></span>
<span id="cb267-11"><a href="data-visualization-with-ggplot2.html#cb267-11"></a><span class="st">  </span><span class="kw">geom_line</span>() </span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-296-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Labeling the graph:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="data-visualization-with-ggplot2.html#cb268-1"></a><span class="co"># notice how we put each argument on its own line when the arguments</span></span>
<span id="cb268-2"><a href="data-visualization-with-ggplot2.html#cb268-2"></a><span class="co"># do not all fit on one line</span></span>
<span id="cb268-3"><a href="data-visualization-with-ggplot2.html#cb268-3"></a><span class="kw">ggplot</span>(avg_delay, <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>delay)) <span class="op">+</span></span>
<span id="cb268-4"><a href="data-visualization-with-ggplot2.html#cb268-4"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb268-5"><a href="data-visualization-with-ggplot2.html#cb268-5"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb268-6"><a href="data-visualization-with-ggplot2.html#cb268-6"></a>    <span class="dt">y =</span> <span class="st">&quot;Average Delay&quot;</span>, </span>
<span id="cb268-7"><a href="data-visualization-with-ggplot2.html#cb268-7"></a>    <span class="dt">title =</span> <span class="st">&quot;Daily Average Departure Delay of Flights from NYC in 2013&quot;</span></span>
<span id="cb268-8"><a href="data-visualization-with-ggplot2.html#cb268-8"></a>  ) <span class="op">+</span></span>
<span id="cb268-9"><a href="data-visualization-with-ggplot2.html#cb268-9"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">365</span>, <span class="dt">by =</span> <span class="dv">28</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-297-1.png" width="75%" style="display: block; margin: auto;" /></p>
<!-- Saving the graph: -->
<!-- ```{r} -->
<!-- pdf(filename = "avg_delay.pdf", width = 10, height = 6) -->
<!-- ggplot(avg_delay, aes(x=Time, y=delay)) + -->
<!--   geom_line() + -->
<!--   labs(y="Average Delay",  -->
<!--        title="Daily Average Departure Delay of Flights from NYC in 2013") -->
<!-- dev.off() -->
<!-- ``` -->
<!-- This will create a pdf file called `avg_delay` in your current working directory (use `getwd()` to find out your current working directory). You can also enter a full path with the file name in `filename`. For example, you can enter `filename = "C:/graphics/avg_delay.pdf"`. -->
<p>By default, the range of the y-axis of a line graph is just enough to include all the y values in the data. Sometimes, you may want to change the range manually. For example, the range of the y-axis in the following graph does not include <code>0</code>.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="data-visualization-with-ggplot2.html#cb269-1"></a><span class="kw">ggplot</span>(BOD, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> demand)) <span class="op">+</span></span>
<span id="cb269-2"><a href="data-visualization-with-ggplot2.html#cb269-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb269-3"><a href="data-visualization-with-ggplot2.html#cb269-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-298-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If you want to include <code>0</code> in the <code>y</code> range, you can use <code>ylim</code>:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="data-visualization-with-ggplot2.html#cb270-1"></a><span class="kw">ggplot</span>(BOD, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> demand)) <span class="op">+</span></span>
<span id="cb270-2"><a href="data-visualization-with-ggplot2.html#cb270-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb270-3"><a href="data-visualization-with-ggplot2.html#cb270-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></span>
<span id="cb270-4"><a href="data-visualization-with-ggplot2.html#cb270-4"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="kw">max</span>(BOD<span class="op">$</span>demand))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-299-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Line Graph with multiple lines</strong></p>
<p>Suppose we want to create a line graph showing the daily average departure delay from the 3 airports in <code>flights</code>.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="data-visualization-with-ggplot2.html#cb271-1"></a><span class="co"># prepare the data</span></span>
<span id="cb271-2"><a href="data-visualization-with-ggplot2.html#cb271-2"></a>flights_delay &lt;-<span class="st"> </span>flights <span class="op">%&gt;%</span></span>
<span id="cb271-3"><a href="data-visualization-with-ggplot2.html#cb271-3"></a><span class="st">  </span><span class="kw">group_by</span>(month, origin) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-4"><a href="data-visualization-with-ggplot2.html#cb271-4"></a><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">delay =</span> <span class="kw">mean</span>(dep_delay, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb271-5"><a href="data-visualization-with-ggplot2.html#cb271-5"></a><span class="st">  </span><span class="kw">ungroup</span>()</span></code></pre></div>
<p>Line Graph:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="data-visualization-with-ggplot2.html#cb272-1"></a><span class="kw">ggplot</span>(flights_delay, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> delay, <span class="dt">color =</span> origin)) <span class="op">+</span></span>
<span id="cb272-2"><a href="data-visualization-with-ggplot2.html#cb272-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb272-3"><a href="data-visualization-with-ggplot2.html#cb272-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-301-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>With different line types:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="data-visualization-with-ggplot2.html#cb273-1"></a><span class="kw">ggplot</span>(flights_delay, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> delay, <span class="dt">linetype =</span> origin)) <span class="op">+</span></span>
<span id="cb273-2"><a href="data-visualization-with-ggplot2.html#cb273-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb273-3"><a href="data-visualization-with-ggplot2.html#cb273-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-302-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Add the points on top of the lines:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="data-visualization-with-ggplot2.html#cb274-1"></a><span class="kw">ggplot</span>(flights_delay, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> delay, <span class="dt">linetype =</span> origin, <span class="dt">color =</span> origin)) <span class="op">+</span></span>
<span id="cb274-2"><a href="data-visualization-with-ggplot2.html#cb274-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb274-3"><a href="data-visualization-with-ggplot2.html#cb274-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb274-4"><a href="data-visualization-with-ggplot2.html#cb274-4"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-303-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Change the point shapes according to <code>origin</code>:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="data-visualization-with-ggplot2.html#cb275-1"></a><span class="kw">ggplot</span>(flights_delay, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> delay, </span>
<span id="cb275-2"><a href="data-visualization-with-ggplot2.html#cb275-2"></a>                          <span class="dt">linetype =</span> origin, <span class="dt">color =</span> origin, <span class="dt">shape =</span> origin)) <span class="op">+</span></span>
<span id="cb275-3"><a href="data-visualization-with-ggplot2.html#cb275-3"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb275-4"><a href="data-visualization-with-ggplot2.html#cb275-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb275-5"><a href="data-visualization-with-ggplot2.html#cb275-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-304-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>To use one single shape for the points, we can specify the shape in <code>geom_point()</code>. The default shape is <code>shape = 16</code>. The default size is <code>size = 2</code>. <code>fill</code> is only applicable for shape = 21 to 25.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="data-visualization-with-ggplot2.html#cb276-1"></a><span class="kw">ggplot</span>(flights_delay, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> delay, <span class="dt">linetype =</span> origin, <span class="dt">color =</span> origin)) <span class="op">+</span></span>
<span id="cb276-2"><a href="data-visualization-with-ggplot2.html#cb276-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb276-3"><a href="data-visualization-with-ggplot2.html#cb276-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">22</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="op">+</span></span>
<span id="cb276-4"><a href="data-visualization-with-ggplot2.html#cb276-4"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-305-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Using another colour palette and changing the size of the lines:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="data-visualization-with-ggplot2.html#cb277-1"></a><span class="kw">ggplot</span>(flights_delay, <span class="kw">aes</span>(<span class="dt">x =</span> month, <span class="dt">y =</span> delay, <span class="dt">color =</span> origin)) <span class="op">+</span></span>
<span id="cb277-2"><a href="data-visualization-with-ggplot2.html#cb277-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb277-3"><a href="data-visualization-with-ggplot2.html#cb277-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">22</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>)<span class="op">+</span></span>
<span id="cb277-4"><a href="data-visualization-with-ggplot2.html#cb277-4"></a><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="op">+</span></span>
<span id="cb277-5"><a href="data-visualization-with-ggplot2.html#cb277-5"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-306-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="scatter-plots" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.3</span> Scatter Plots<a href="data-visualization-with-ggplot2.html#scatter-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Scatter plots are often used to visualize the relationship between two continuous variables. It is also possible to use a scatter plot when either or both variables are discrete.</p>
<p>The dataset <code>heightweight</code> contains sex, age, height and weight of some schoolchildren.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="data-visualization-with-ggplot2.html#cb278-1"></a><span class="kw">head</span>(heightweight)</span>
<span id="cb278-2"><a href="data-visualization-with-ggplot2.html#cb278-2"></a><span class="co">##   sex ageYear ageMonth heightIn weightLb</span></span>
<span id="cb278-3"><a href="data-visualization-with-ggplot2.html#cb278-3"></a><span class="co">## 1   f   11.92      143     56.3     85.0</span></span>
<span id="cb278-4"><a href="data-visualization-with-ggplot2.html#cb278-4"></a><span class="co">## 2   f   12.92      155     62.3    105.0</span></span>
<span id="cb278-5"><a href="data-visualization-with-ggplot2.html#cb278-5"></a><span class="co">## 3   f   12.75      153     63.3    108.0</span></span>
<span id="cb278-6"><a href="data-visualization-with-ggplot2.html#cb278-6"></a><span class="co">## 4   f   13.42      161     59.0     92.0</span></span>
<span id="cb278-7"><a href="data-visualization-with-ggplot2.html#cb278-7"></a><span class="co">## 5   f   15.92      191     62.5    112.5</span></span>
<span id="cb278-8"><a href="data-visualization-with-ggplot2.html#cb278-8"></a><span class="co">## 6   f   14.25      171     62.5    112.0</span></span></code></pre></div>
<p>To create a basic scatter plot, use <code>geom_point()</code>:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="data-visualization-with-ggplot2.html#cb279-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn)) <span class="op">+</span></span>
<span id="cb279-2"><a href="data-visualization-with-ggplot2.html#cb279-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-308-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can control the shape, size, and color of the points as illustrated in the last section.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="data-visualization-with-ggplot2.html#cb280-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn)) <span class="op">+</span></span>
<span id="cb280-2"><a href="data-visualization-with-ggplot2.html#cb280-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">shape =</span> <span class="dv">4</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-309-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>If shape = 21-25, you can control the color in the points and outline of the points using <code>fill</code> and <code>color</code>, respectively.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="data-visualization-with-ggplot2.html#cb281-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn)) <span class="op">+</span></span>
<span id="cb281-2"><a href="data-visualization-with-ggplot2.html#cb281-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">shape =</span> <span class="dv">22</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-310-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Visualizing an additional discrete variable</strong></p>
<p>Suppose you want to use different colours for the points according to different categories of <code>sex</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="data-visualization-with-ggplot2.html#cb282-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">color =</span> sex)) <span class="op">+</span></span>
<span id="cb282-2"><a href="data-visualization-with-ggplot2.html#cb282-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-311-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Suppose you want to use different shapes for the points according to different categories of <code>sex</code>.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="data-visualization-with-ggplot2.html#cb283-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">shape =</span> sex)) <span class="op">+</span></span>
<span id="cb283-2"><a href="data-visualization-with-ggplot2.html#cb283-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-312-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can use colours and shapes at the same time:</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="data-visualization-with-ggplot2.html#cb284-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">shape =</span> sex, <span class="dt">color =</span> sex)) <span class="op">+</span></span>
<span id="cb284-2"><a href="data-visualization-with-ggplot2.html#cb284-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-313-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You can change the shapes or colours manually:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="data-visualization-with-ggplot2.html#cb285-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">shape =</span> sex, <span class="dt">color =</span> sex)) <span class="op">+</span></span>
<span id="cb285-2"><a href="data-visualization-with-ggplot2.html#cb285-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb285-3"><a href="data-visualization-with-ggplot2.html#cb285-3"></a><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">22</span>)) <span class="op">+</span></span>
<span id="cb285-4"><a href="data-visualization-with-ggplot2.html#cb285-4"></a><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set2&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-314-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Visualizing an additional continuous variable</strong></p>
<p>You may map an additional continuous variable to <code>color</code>.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="data-visualization-with-ggplot2.html#cb286-1"></a><span class="kw">ggplot</span>(heightweight, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">color =</span> weightLb)) <span class="op">+</span></span>
<span id="cb286-2"><a href="data-visualization-with-ggplot2.html#cb286-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-315-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Visualizing two additional discrete variables</strong></p>
<p>Let’s create a new column to indicate if the child weights &lt; 100 or &gt;= 100 pounds (this is a discrete variable).</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="data-visualization-with-ggplot2.html#cb287-1"></a>heightweight2 &lt;-<span class="st"> </span>heightweight <span class="op">%&gt;%</span></span>
<span id="cb287-2"><a href="data-visualization-with-ggplot2.html#cb287-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weightgroup =</span> <span class="kw">ifelse</span>(weightLb <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;&lt; 100&quot;</span>, <span class="st">&quot;&gt;= 100&quot;</span>))</span></code></pre></div>
<p>Now, we can add both <code>sex</code> and <code>weightgroup</code> in the plot in the following way:</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="data-visualization-with-ggplot2.html#cb288-1"></a><span class="kw">ggplot</span>(heightweight2, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">shape =</span> sex, <span class="dt">fill =</span> weightgroup)) <span class="op">+</span></span>
<span id="cb288-2"><a href="data-visualization-with-ggplot2.html#cb288-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb288-3"><a href="data-visualization-with-ggplot2.html#cb288-3"></a><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="op">+</span></span>
<span id="cb288-4"><a href="data-visualization-with-ggplot2.html#cb288-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(</span>
<span id="cb288-5"><a href="data-visualization-with-ggplot2.html#cb288-5"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb288-6"><a href="data-visualization-with-ggplot2.html#cb288-6"></a>    <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">21</span>)) <span class="co"># to change the legend</span></span>
<span id="cb288-7"><a href="data-visualization-with-ggplot2.html#cb288-7"></a>  ) </span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-317-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Changing the mark ticks, limits and labels of the x-axis and y-axis:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="data-visualization-with-ggplot2.html#cb289-1"></a><span class="kw">ggplot</span>(heightweight2, <span class="kw">aes</span>(<span class="dt">x =</span> ageYear, <span class="dt">y =</span> heightIn, <span class="dt">shape =</span> sex, <span class="dt">fill =</span> weightgroup)) <span class="op">+</span></span>
<span id="cb289-2"><a href="data-visualization-with-ggplot2.html#cb289-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb289-3"><a href="data-visualization-with-ggplot2.html#cb289-3"></a><span class="st">  </span><span class="kw">scale_shape_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">24</span>)) <span class="op">+</span></span>
<span id="cb289-4"><a href="data-visualization-with-ggplot2.html#cb289-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(</span>
<span id="cb289-5"><a href="data-visualization-with-ggplot2.html#cb289-5"></a>    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb289-6"><a href="data-visualization-with-ggplot2.html#cb289-6"></a>    <span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">shape =</span> <span class="dv">21</span>)) <span class="co"># to change the legend</span></span>
<span id="cb289-7"><a href="data-visualization-with-ggplot2.html#cb289-7"></a>  ) <span class="op">+</span></span>
<span id="cb289-8"><a href="data-visualization-with-ggplot2.html#cb289-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Age (Year)&quot;</span>, <span class="dt">breaks =</span> <span class="dv">11</span><span class="op">:</span><span class="dv">18</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">11</span>, <span class="dv">18</span>)) <span class="op">+</span></span>
<span id="cb289-9"><a href="data-visualization-with-ggplot2.html#cb289-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Height (In)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">50</span>, <span class="dv">70</span>, <span class="dv">5</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">73</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-318-1.png" width="75%" style="display: block; margin: auto;" /></p>
<div id="overplotting" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.3.1</span> Overplotting<a href="data-visualization-with-ggplot2.html#overplotting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Overplotting refers to the situation when you have a large dataset so that the points in a scatter plot overlap and obscure each other.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="data-visualization-with-ggplot2.html#cb290-1"></a><span class="co"># We can create a variable to store the &quot;ggplot&quot; </span></span>
<span id="cb290-2"><a href="data-visualization-with-ggplot2.html#cb290-2"></a>diamonds_ggplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> carat, <span class="dt">y =</span> price))</span>
<span id="cb290-3"><a href="data-visualization-with-ggplot2.html#cb290-3"></a>diamonds_ggplot <span class="op">+</span></span>
<span id="cb290-4"><a href="data-visualization-with-ggplot2.html#cb290-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-319-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Possible solutions for overplotting:</p>
<ol style="list-style-type: decimal">
<li>Use smaller points (<code>size</code>)</li>
</ol>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="data-visualization-with-ggplot2.html#cb291-1"></a><span class="co"># with diamonds_ggplot, we do not have to type </span></span>
<span id="cb291-2"><a href="data-visualization-with-ggplot2.html#cb291-2"></a><span class="co"># ggplot(diamonds, aes(x = carat, y = price))</span></span>
<span id="cb291-3"><a href="data-visualization-with-ggplot2.html#cb291-3"></a>diamonds_ggplot <span class="op">+</span></span>
<span id="cb291-4"><a href="data-visualization-with-ggplot2.html#cb291-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-320-1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: decimal">
<li>Make the points semitransparent (<code>alpha</code>)</li>
</ol>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="data-visualization-with-ggplot2.html#cb292-1"></a>diamonds_ggplot <span class="op">+</span></span>
<span id="cb292-2"><a href="data-visualization-with-ggplot2.html#cb292-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.05</span>, <span class="dt">size =</span> <span class="fl">0.1</span>) <span class="co"># 0.05 = 95% transparent</span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-321-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>We can see some vertical bands at some values of carats, meaning that diamonds tend to be cut to those sizes.</p>
<ol start="3" style="list-style-type: decimal">
<li>Bin the data into rectangles (<code>stat_bin2d</code>)</li>
</ol>
<p><code>bins</code> controls the number of bins in the x and y directions. The color of the rectangle indicates how many data points there are in the region.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="data-visualization-with-ggplot2.html#cb293-1"></a><span class="co"># by default, bins = 30</span></span>
<span id="cb293-2"><a href="data-visualization-with-ggplot2.html#cb293-2"></a>diamonds_ggplot <span class="op">+</span></span>
<span id="cb293-3"><a href="data-visualization-with-ggplot2.html#cb293-3"></a><span class="st">  </span><span class="kw">stat_bin2d</span>(<span class="dt">bins =</span> <span class="dv">3</span>)  </span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-322-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>With <code>bins = 50</code>:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="data-visualization-with-ggplot2.html#cb294-1"></a>diamonds_ggplot <span class="op">+</span></span>
<span id="cb294-2"><a href="data-visualization-with-ggplot2.html#cb294-2"></a><span class="st">  </span><span class="kw">stat_bin2d</span>(<span class="dt">bins =</span> <span class="dv">50</span>) <span class="op">+</span></span>
<span id="cb294-3"><a href="data-visualization-with-ggplot2.html#cb294-3"></a><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-323-1.png" width="75%" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Overplotting can also occur when the data is discrete on one or both axes.</li>
</ol>
<p>In the following example, we use the dataset <code>ChickWeight</code>, where <code>Time</code> is a discrete variable.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="data-visualization-with-ggplot2.html#cb295-1"></a><span class="kw">head</span>(ChickWeight)</span>
<span id="cb295-2"><a href="data-visualization-with-ggplot2.html#cb295-2"></a><span class="co">##   weight Time Chick Diet</span></span>
<span id="cb295-3"><a href="data-visualization-with-ggplot2.html#cb295-3"></a><span class="co">## 1     42    0     1    1</span></span>
<span id="cb295-4"><a href="data-visualization-with-ggplot2.html#cb295-4"></a><span class="co">## 2     51    2     1    1</span></span>
<span id="cb295-5"><a href="data-visualization-with-ggplot2.html#cb295-5"></a><span class="co">## 3     59    4     1    1</span></span>
<span id="cb295-6"><a href="data-visualization-with-ggplot2.html#cb295-6"></a><span class="co">## 4     64    6     1    1</span></span>
<span id="cb295-7"><a href="data-visualization-with-ggplot2.html#cb295-7"></a><span class="co">## 5     76    8     1    1</span></span>
<span id="cb295-8"><a href="data-visualization-with-ggplot2.html#cb295-8"></a><span class="co">## 6     93   10     1    1</span></span></code></pre></div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="data-visualization-with-ggplot2.html#cb296-1"></a><span class="co"># create a base plot</span></span>
<span id="cb296-2"><a href="data-visualization-with-ggplot2.html#cb296-2"></a>cw_ggplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(ChickWeight, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> weight))</span>
<span id="cb296-3"><a href="data-visualization-with-ggplot2.html#cb296-3"></a>cw_ggplot <span class="op">+</span></span>
<span id="cb296-4"><a href="data-visualization-with-ggplot2.html#cb296-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-325-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>You may randomly jitter the points:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="data-visualization-with-ggplot2.html#cb297-1"></a>cw_ggplot <span class="op">+</span></span>
<span id="cb297-2"><a href="data-visualization-with-ggplot2.html#cb297-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-326-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Jittering the points means a small amount of random variation is added to the location of each point. If you only want to jitter in the x-direction:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="data-visualization-with-ggplot2.html#cb298-1"></a>cw_ggplot <span class="op">+</span></span>
<span id="cb298-2"><a href="data-visualization-with-ggplot2.html#cb298-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">height =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-327-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="labelling-points-in-a-scatter-plot" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.3.2</span> Labelling points in a scatter plot<a href="data-visualization-with-ggplot2.html#labelling-points-in-a-scatter-plot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use <code>annotate()</code> or <code>geom_text_repel()</code> to label points in a scatter plot. For the latter, we have to install the package ggrepel.</p>
<p>We will use the <code>countries</code> dataset in the package gcookbook and visualize the relationship between health expenditures and infant mortality rate. We will consider a subset of data by focusing the data from 2009 and countries with more than <span class="math inline">\(2,000\)</span> USD health expenditures per capita:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="data-visualization-with-ggplot2.html#cb299-1"></a>countries_subset &lt;-<span class="st"> </span>countries <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb299-2"><a href="data-visualization-with-ggplot2.html#cb299-2"></a><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">==</span><span class="st"> </span><span class="dv">2009</span>, healthexp <span class="op">&gt;</span><span class="st"> </span><span class="dv">2000</span>)</span></code></pre></div>
<p>Using annotate:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="data-visualization-with-ggplot2.html#cb300-1"></a><span class="co"># find out the x and y coordinates for the point corresponding to Canada</span></span>
<span id="cb300-2"><a href="data-visualization-with-ggplot2.html#cb300-2"></a>canada_x &lt;-<span class="st"> </span><span class="kw">filter</span>(countries_subset, Name <span class="op">==</span><span class="st"> &quot;Canada&quot;</span>)<span class="op">$</span>healthexp</span>
<span id="cb300-3"><a href="data-visualization-with-ggplot2.html#cb300-3"></a>canada_y &lt;-<span class="st"> </span><span class="kw">filter</span>(countries_subset, Name <span class="op">==</span><span class="st"> &quot;Canada&quot;</span>)<span class="op">$</span>infmortality</span>
<span id="cb300-4"><a href="data-visualization-with-ggplot2.html#cb300-4"></a></span>
<span id="cb300-5"><a href="data-visualization-with-ggplot2.html#cb300-5"></a><span class="kw">ggplot</span>(countries_subset, <span class="kw">aes</span>(<span class="dt">x =</span> healthexp, <span class="dt">y =</span> infmortality)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb300-6"><a href="data-visualization-with-ggplot2.html#cb300-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb300-7"><a href="data-visualization-with-ggplot2.html#cb300-7"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> canada_x, <span class="dt">y =</span> canada_y <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>, <span class="dt">label =</span> <span class="st">&quot;Canada&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-329-1.png" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="data-visualization-with-ggplot2.html#cb301-1"></a><span class="co"># + 0.2 is to avoid the label placing on top of the point</span></span></code></pre></div>
<p>Label all the points with <code>geom_text_repel</code>:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="data-visualization-with-ggplot2.html#cb302-1"></a><span class="co"># to use geom_text_repel, load the package ggrepel</span></span>
<span id="cb302-2"><a href="data-visualization-with-ggplot2.html#cb302-2"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb302-3"><a href="data-visualization-with-ggplot2.html#cb302-3"></a><span class="kw">ggplot</span>(countries_subset, <span class="kw">aes</span>(<span class="dt">x =</span> healthexp, <span class="dt">y =</span> infmortality)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb302-4"><a href="data-visualization-with-ggplot2.html#cb302-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb302-5"><a href="data-visualization-with-ggplot2.html#cb302-5"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Name), <span class="dt">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-330-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Label all the points with <code>geom_label_repel</code> (with a box around the label):</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="data-visualization-with-ggplot2.html#cb303-1"></a><span class="co"># geom_label_repel also depends on the package ggrepel</span></span>
<span id="cb303-2"><a href="data-visualization-with-ggplot2.html#cb303-2"></a><span class="kw">ggplot</span>(countries_subset, <span class="kw">aes</span>(<span class="dt">x =</span> healthexp, <span class="dt">y =</span> infmortality)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb303-3"><a href="data-visualization-with-ggplot2.html#cb303-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb303-4"><a href="data-visualization-with-ggplot2.html#cb303-4"></a><span class="st">  </span><span class="kw">geom_label_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Name), <span class="dt">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-331-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="summarizing-data-distributions" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.4</span> Summarizing Data Distributions<a href="data-visualization-with-ggplot2.html#summarizing-data-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="histogram-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.4.1</span> Histogram<a href="data-visualization-with-ggplot2.html#histogram-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Histogram can be used to visualize the distribution of a variable. We will illustrate how to create histograms using the dataset <code>birthwt</code> from the package MASS.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="data-visualization-with-ggplot2.html#cb304-1"></a><span class="kw">library</span>(MASS)</span></code></pre></div>
<p><code>birthwt</code> contains data of 189 birth weights with some covariates of the mothers.</p>
<p>Take a look at the dataset:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="data-visualization-with-ggplot2.html#cb305-1"></a><span class="kw">head</span>(birthwt)</span>
<span id="cb305-2"><a href="data-visualization-with-ggplot2.html#cb305-2"></a><span class="co">##    low age lwt race smoke ptl ht ui ftv  bwt</span></span>
<span id="cb305-3"><a href="data-visualization-with-ggplot2.html#cb305-3"></a><span class="co">## 85   0  19 182    2     0   0  0  1   0 2523</span></span>
<span id="cb305-4"><a href="data-visualization-with-ggplot2.html#cb305-4"></a><span class="co">## 86   0  33 155    3     0   0  0  0   3 2551</span></span>
<span id="cb305-5"><a href="data-visualization-with-ggplot2.html#cb305-5"></a><span class="co">## 87   0  20 105    1     1   0  0  0   1 2557</span></span>
<span id="cb305-6"><a href="data-visualization-with-ggplot2.html#cb305-6"></a><span class="co">## 88   0  21 108    1     1   0  0  1   2 2594</span></span>
<span id="cb305-7"><a href="data-visualization-with-ggplot2.html#cb305-7"></a><span class="co">## 89   0  18 107    1     1   0  0  1   0 2600</span></span>
<span id="cb305-8"><a href="data-visualization-with-ggplot2.html#cb305-8"></a><span class="co">## 91   0  21 124    3     0   0  0  0   0 2622</span></span></code></pre></div>
<p>Basic histogram:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="data-visualization-with-ggplot2.html#cb306-1"></a><span class="kw">ggplot</span>(birthwt, <span class="kw">aes</span>(<span class="dt">x=</span>bwt)) <span class="op">+</span></span>
<span id="cb306-2"><a href="data-visualization-with-ggplot2.html#cb306-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-335-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Plot a histogram with density (not frequency):</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="data-visualization-with-ggplot2.html#cb307-1"></a><span class="kw">ggplot</span>(birthwt, <span class="kw">aes</span>(<span class="dt">x=</span>bwt)) <span class="op">+</span></span>
<span id="cb307-2"><a href="data-visualization-with-ggplot2.html#cb307-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..))</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-336-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>To compare two histograms</strong></p>
<ol style="list-style-type: decimal">
<li>Use <code>facet_grid()</code> to display two histograms in the same plot.</li>
</ol>
<p>Suppose we group the data according to the smoking status during pregnancy and we want to display the two histograms of the birth weight:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="data-visualization-with-ggplot2.html#cb308-1"></a><span class="kw">ggplot</span>(birthwt, <span class="kw">aes</span>(<span class="dt">x =</span> bwt)) <span class="op">+</span></span>
<span id="cb308-2"><a href="data-visualization-with-ggplot2.html#cb308-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb308-3"><a href="data-visualization-with-ggplot2.html#cb308-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(smoke <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-337-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>To change the label, we can change the content of the variable:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="data-visualization-with-ggplot2.html#cb309-1"></a><span class="co"># create another dataset</span></span>
<span id="cb309-2"><a href="data-visualization-with-ggplot2.html#cb309-2"></a>birthwt_mod &lt;-<span class="st"> </span>birthwt</span>
<span id="cb309-3"><a href="data-visualization-with-ggplot2.html#cb309-3"></a>birthwt_mod<span class="op">$</span>smoke &lt;-<span class="st"> </span><span class="kw">ifelse</span>(birthwt_mod<span class="op">$</span>smoke <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Smoke&quot;</span>, <span class="st">&quot;No Smoke&quot;</span>)</span>
<span id="cb309-4"><a href="data-visualization-with-ggplot2.html#cb309-4"></a></span>
<span id="cb309-5"><a href="data-visualization-with-ggplot2.html#cb309-5"></a><span class="kw">ggplot</span>(birthwt_mod, <span class="kw">aes</span>(<span class="dt">x =</span> bwt)) <span class="op">+</span></span>
<span id="cb309-6"><a href="data-visualization-with-ggplot2.html#cb309-6"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb309-7"><a href="data-visualization-with-ggplot2.html#cb309-7"></a><span class="st">  </span><span class="kw">facet_grid</span>(smoke <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-338-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Alternatively, we can use <code>recode_factor</code>:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="data-visualization-with-ggplot2.html#cb310-1"></a>birthwt_mod<span class="op">$</span>smoke &lt;-<span class="st"> </span><span class="kw">recode_factor</span>(birthwt_mod<span class="op">$</span>smoke, </span>
<span id="cb310-2"><a href="data-visualization-with-ggplot2.html#cb310-2"></a>                                   <span class="st">&quot;0&quot;</span> =<span class="st"> &quot;No Smoke&quot;</span>, <span class="st">&quot;1&quot;</span> =<span class="st"> &quot;Smoke&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Use <code>fill()</code> to put two groups in the same plot with different colors. We need to set <code>position = "identity"</code>; otherwise, the bars will be stacked on top of each other vertically which is not what we want.</li>
</ol>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="data-visualization-with-ggplot2.html#cb311-1"></a><span class="kw">ggplot</span>(birthwt_mod, <span class="kw">aes</span>(<span class="dt">x=</span>bwt, <span class="dt">fill=</span>smoke)) <span class="op">+</span></span>
<span id="cb311-2"><a href="data-visualization-with-ggplot2.html#cb311-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="co">#+</span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-340-1.png" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="data-visualization-with-ggplot2.html#cb312-1"></a><span class="co">#  facet_grid(race~., scales=&quot;free&quot;)</span></span></code></pre></div>
<p>It is also possible to use both <code>facet_grid</code> and <code>fill</code> when we have want to group the data with two discrete variables. We will illustrate this with grouping according to the smoking status and the race. We also add <code>scales = "free"</code> so that the ranges of the y-axes will be adjusted according to the data in each histogram.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="data-visualization-with-ggplot2.html#cb313-1"></a><span class="co"># change the name so that the labels can be understood easily</span></span>
<span id="cb313-2"><a href="data-visualization-with-ggplot2.html#cb313-2"></a>birthwt_mod<span class="op">$</span>race[<span class="kw">which</span>(birthwt_mod<span class="op">$</span>race<span class="op">==</span><span class="dv">1</span>)] =<span class="st"> &quot;White&quot;</span></span>
<span id="cb313-3"><a href="data-visualization-with-ggplot2.html#cb313-3"></a>birthwt_mod<span class="op">$</span>race[<span class="kw">which</span>(birthwt_mod<span class="op">$</span>race<span class="op">==</span><span class="dv">2</span>)] =<span class="st"> &quot;Black&quot;</span></span>
<span id="cb313-4"><a href="data-visualization-with-ggplot2.html#cb313-4"></a>birthwt_mod<span class="op">$</span>race[<span class="kw">which</span>(birthwt_mod<span class="op">$</span>race<span class="op">==</span><span class="dv">3</span>)] =<span class="st"> &quot;Other&quot;</span></span>
<span id="cb313-5"><a href="data-visualization-with-ggplot2.html#cb313-5"></a></span>
<span id="cb313-6"><a href="data-visualization-with-ggplot2.html#cb313-6"></a><span class="kw">ggplot</span>(birthwt_mod, <span class="kw">aes</span>(<span class="dt">x =</span> bwt, <span class="dt">fill =</span> smoke)) <span class="op">+</span></span>
<span id="cb313-7"><a href="data-visualization-with-ggplot2.html#cb313-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb313-8"><a href="data-visualization-with-ggplot2.html#cb313-8"></a><span class="st">  </span><span class="kw">facet_grid</span>(race <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-341-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Note: we do not have a large dataset in this example so that grouping by two variables may not give us a very good understanding of the data.</p>
</div>
<div id="kernel-density-estimate" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.4.2</span> Kernel Density Estimate<a href="data-visualization-with-ggplot2.html#kernel-density-estimate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Kernel density estimation is a nonparametric method to estimate the density of the samples. Nonparametric method means we do not impose a parametric model. A parametric model has a finite dimensional parameter <span class="math inline">\(\theta \in \mathbb{R}^d\)</span> for some finite <span class="math inline">\(d\)</span>. Let <span class="math inline">\(X_1,\ldots,X_n\)</span> be i.i.d. random variables from some distribution with density <span class="math inline">\(f\)</span>. The histogram for <span class="math inline">\(f\)</span> at point <span class="math inline">\(x_0\)</span> is
<span class="math display">\[\begin{equation*}
\hat{f}(x_0) = \frac{\text{number of $x_i$ in the bin containing $x_0$}}{n h},
\end{equation*}\]</span>
where the bin width is <span class="math inline">\(h\)</span>. As we already know, the histogram will not give a smooth estimate of the density. One may use another method called kernel density estimator, which could produce smooth estimate of the density. The kernel density estimator is
<span class="math display">\[\begin{equation*}
\hat{f}_n(x_0) = \frac{1}{nh}\sum^n_{i=1} K \bigg( \frac{x_0 - x_i}{h} \bigg),
\end{equation*}\]</span>
where <span class="math inline">\(K\)</span> is a kernel and <span class="math inline">\(h\)</span> is the bandwidth. For our purposes, a kernel is a non-negative symmetric function such that <span class="math inline">\(\int^\infty_{-\infty}K(x)dx = 1\)</span> and <span class="math inline">\(\int^\infty_{-\infty} x K(x)dx =0\)</span>. For example,
<span class="math display">\[\begin{eqnarray*}
\text{the boxcar kernel:} &amp;&amp; K(x) = \frac{1}{2}I(|x| \leq 1)\\
\text{the Gaussian kernel:} &amp;&amp; K(x) = \frac{1}{\sqrt{2\pi}} e^{-x^2/2} \\
\text{the Epanechnikov kernel:} &amp;&amp; K(x) = \frac{3}{4}(1-x^2)I(|x| \leq 1) \\
\text{the tricube kernel:} &amp;&amp; K(x) = \frac{70}{81}(1-|x|^3)^3I(|x| \leq 1),
\end{eqnarray*}\]</span>
where <span class="math inline">\(I(|x| \leq 1) = 1\)</span> if <span class="math inline">\(|x| \leq 1\)</span> and equals <span class="math inline">\(0\)</span> otherwise.</p>
<p><img src="Book_files/figure-html/unnamed-chunk-342-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>Since the kernel is symmetric around <span class="math inline">\(0\)</span>, the magnitude <span class="math inline">\((x-x_i)/h\)</span> is the distance from <span class="math inline">\(0\)</span>. For the above kernels, the value of the kernels is smaller when we evaluate at a point further from <span class="math inline">\(0\)</span>. Therefore, data close to <span class="math inline">\(x_0\)</span> will contribute larger weights in estimating <span class="math inline">\(\hat{f}(x_0)\)</span>.</p>
<p>The bandwidth will control the smoothness of the estimate: larger bandwidth will result in a smoother curve and smaller bandwidth will result in a noisy and rough curve. We can create a kernel density estimate of the distribution using <code>geom_density()</code>.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="data-visualization-with-ggplot2.html#cb314-1"></a><span class="kw">ggplot</span>(birthwt, <span class="kw">aes</span>(<span class="dt">x =</span> bwt)) <span class="op">+</span></span>
<span id="cb314-2"><a href="data-visualization-with-ggplot2.html#cb314-2"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb314-3"><a href="data-visualization-with-ggplot2.html#cb314-3"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="fl">0.25</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># smaller bandwidth -&gt; noisy</span></span>
<span id="cb314-4"><a href="data-visualization-with-ggplot2.html#cb314-4"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">adjust =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="co"># large bandwidth -&gt; smoother</span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-343-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Overlaying a density curve with a histogram</strong></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="data-visualization-with-ggplot2.html#cb315-1"></a><span class="kw">ggplot</span>(birthwt, <span class="kw">aes</span>(<span class="dt">x =</span> bwt)) <span class="op">+</span></span>
<span id="cb315-2"><a href="data-visualization-with-ggplot2.html#cb315-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill =</span> <span class="st">&quot;cornsilk&quot;</span>, <span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) <span class="op">+</span></span>
<span id="cb315-3"><a href="data-visualization-with-ggplot2.html#cb315-3"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-344-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p><strong>Displaying kernel density Estimates from grouped data</strong></p>
<p>To use <code>geom_density()</code> to display kernel density estimates from grouped data, the grouping variable must be a factor or a character vector. Recall that in <code>birthwt_mod</code> that we created earlier, the smoke variable is a character vector.</p>
<p>With <code>color</code>:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="data-visualization-with-ggplot2.html#cb316-1"></a><span class="kw">ggplot</span>(birthwt_mod, <span class="kw">aes</span>(<span class="dt">x =</span> bwt, <span class="dt">color =</span> smoke)) <span class="op">+</span></span>
<span id="cb316-2"><a href="data-visualization-with-ggplot2.html#cb316-2"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-345-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>With <code>fill</code>:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="data-visualization-with-ggplot2.html#cb317-1"></a><span class="kw">ggplot</span>(birthwt_mod, <span class="kw">aes</span>(<span class="dt">x =</span> bwt, <span class="dt">fill =</span> smoke)) <span class="op">+</span></span>
<span id="cb317-2"><a href="data-visualization-with-ggplot2.html#cb317-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="co"># to control the transparency </span></span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-346-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>With <code>facet_grid()</code>:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="data-visualization-with-ggplot2.html#cb318-1"></a><span class="kw">ggplot</span>(birthwt_mod, <span class="kw">aes</span>(<span class="dt">x =</span> bwt)) <span class="op">+</span></span>
<span id="cb318-2"><a href="data-visualization-with-ggplot2.html#cb318-2"></a><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></span>
<span id="cb318-3"><a href="data-visualization-with-ggplot2.html#cb318-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(smoke <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="Book_files/figure-html/unnamed-chunk-347-1.png" width="75%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="saving-your-plots" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.5</span> Saving your plots<a href="data-visualization-with-ggplot2.html#saving-your-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two types of image files: <strong>vector</strong> and <strong>raster (bitmap)</strong></p>
<p><strong>Raster images</strong> are pixel-based. When you zoom in the image, you can see the individual pixels. Two examples are JPG and PNG files. JPG files’ quality is lower than that of the PNG files.</p>
<p><strong>Vector images</strong> are constructed using mathematical formulas. You can resize the image without a loss in image quality. When you zoom in the image, it is still smooth and clear. Two examples are AI and PDF files.</p>
<div id="outputting-to-pdf-vector-files" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.5.1</span> Outputting to pdf vector files<a href="data-visualization-with-ggplot2.html#outputting-to-pdf-vector-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose you want to save the plot from the following code:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="data-visualization-with-ggplot2.html#cb319-1"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></span>
<span id="cb319-2"><a href="data-visualization-with-ggplot2.html#cb319-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="data-visualization-with-ggplot2.html#cb320-1"></a><span class="co"># first argument is the file name</span></span>
<span id="cb320-2"><a href="data-visualization-with-ggplot2.html#cb320-2"></a><span class="co"># width and height are in inches</span></span>
<span id="cb320-3"><a href="data-visualization-with-ggplot2.html#cb320-3"></a><span class="kw">pdf</span>(<span class="st">&quot;filename.pdf&quot;</span>, <span class="dt">width =</span> <span class="dv">4</span>, <span class="dt">height =</span> <span class="dv">4</span>)</span>
<span id="cb320-4"><a href="data-visualization-with-ggplot2.html#cb320-4"></a></span>
<span id="cb320-5"><a href="data-visualization-with-ggplot2.html#cb320-5"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span></span>
<span id="cb320-6"><a href="data-visualization-with-ggplot2.html#cb320-6"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb320-7"><a href="data-visualization-with-ggplot2.html#cb320-7"></a></span>
<span id="cb320-8"><a href="data-visualization-with-ggplot2.html#cb320-8"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<p>Outputting to a pdf file:</p>
<ul>
<li>usually the best option</li>
<li>usually smaller than bitmap files such as PNG files.</li>
<li>when you have overplotting (many points on the plot), a PDF file can be much larger than a PNG file.</li>
</ul>
</div>
<div id="outputting-to-bitmap-files" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.5.2</span> Outputting to bitmap files<a href="data-visualization-with-ggplot2.html#outputting-to-bitmap-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="data-visualization-with-ggplot2.html#cb321-1"></a><span class="co"># width and heights are in pixels</span></span>
<span id="cb321-2"><a href="data-visualization-with-ggplot2.html#cb321-2"></a><span class="kw">png</span>(<span class="st">&quot;png_plot.png&quot;</span>, <span class="dt">width =</span> <span class="dv">600</span>, <span class="dt">height =</span> <span class="dv">600</span>)</span>
<span id="cb321-3"><a href="data-visualization-with-ggplot2.html#cb321-3"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span>wt,<span class="dt">y=</span>mpg)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb321-4"><a href="data-visualization-with-ggplot2.html#cb321-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb321-5"><a href="data-visualization-with-ggplot2.html#cb321-5"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<p>For high-quality print output, it is recommended to use <strong>at least 300 ppi</strong> (ppi = pixels per inch). Suppose you want to create a 4x4-inch PNG file with 300 ppi:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="data-visualization-with-ggplot2.html#cb322-1"></a>ppi &lt;-<span class="st"> </span><span class="dv">300</span></span>
<span id="cb322-2"><a href="data-visualization-with-ggplot2.html#cb322-2"></a><span class="kw">png</span>(<span class="st">&quot;png_plot.png&quot;</span>, <span class="dt">width =</span> <span class="dv">4</span><span class="op">*</span>ppi, <span class="dt">height =</span> <span class="dv">4</span><span class="op">*</span>ppi, <span class="dt">res =</span> ppi)</span>
<span id="cb322-3"><a href="data-visualization-with-ggplot2.html#cb322-3"></a><span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb322-4"><a href="data-visualization-with-ggplot2.html#cb322-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span>
<span id="cb322-5"><a href="data-visualization-with-ggplot2.html#cb322-5"></a><span class="kw">dev.off</span>()</span></code></pre></div>
</div>
</div>
<div id="summary-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">8.6</span> Summary<a href="data-visualization-with-ggplot2.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="combining-multiple-operations-with-pipe-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.6.1</span> Combining multiple operations with pipe <code>%&gt;%</code><a href="data-visualization-with-ggplot2.html#combining-multiple-operations-with-pipe-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="bar-charts-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.6.2</span> Bar charts<a href="data-visualization-with-ggplot2.html#bar-charts-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>examples of using pipe <code>%&gt;%</code> together with <code>ggplot</code></li>
<li>create bar charts of counts</li>
<li>create bar charts of values</li>
<li>change “fill” and “outline” of the bars</li>
<li>create grouped bar charts</li>
<li>create stacked bar charts</li>
<li>convert a variable into factor in ggplot</li>
<li>use different colour palette</li>
<li>control the width of the bars</li>
</ol>
</div>
<div id="line-graphs" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.6.3</span> Line graphs<a href="data-visualization-with-ggplot2.html#line-graphs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>create line graphs</li>
<li>label the graph</li>
<li>change the range of y-axis</li>
<li>create line graphs with multiple lines</li>
<li>use multiple geoms (geometric objects) (e.g. additing the points on top of the lines)</li>
<li>change shape, size, fill, outline of points</li>
<li>change line type</li>
</ol>
</div>
<div id="scatter-plot-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.6.4</span> Scatter plot<a href="data-visualization-with-ggplot2.html#scatter-plot-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>create scatter plots</li>
<li>visualize an additional discrete variable</li>
<li>visualize an additional continuous variable</li>
<li>visualize two additional discrete variables</li>
<li>overplotting (use smaller points, make points semitransparent, bin data into rectangels, jitter the points)</li>
<li>label points in a scatter plot</li>
</ol>
</div>
<div id="summarizing-data-distributions-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.6.5</span> Summarizing data distributions<a href="data-visualization-with-ggplot2.html#summarizing-data-distributions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>create histograms (frequency and density)</li>
<li>compare two histograms (<code>facet_grid()</code>, <code>fill()</code>)</li>
<li>create histograms with two additional discrete variables</li>
<li>create kernel density estimates</li>
<li>overlay a density curve with a histogram</li>
<li>display kernel density estimates from grouped data (<code>color</code>, <code>fill</code>, <code>facet_grid</code>)</li>
</ol>
</div>
<div id="saving-your-plots-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">8.6.6</span> Saving your plots<a href="data-visualization-with-ggplot2.html#saving-your-plots-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>output to pdf vector files</li>
<li>output to bitmap files</li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-transformation-with-dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistical-inference-in-r.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Book.pdf", "Book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
